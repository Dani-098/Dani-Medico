<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Practice Tests - Dani Medico</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.25/jspdf.plugin.autotable.min.js"></script>
    <style>
        /* Enhanced CSS with Gradients and Animations */
        :root {
            --color-primary-blue: #007BFF;
            --color-primary-blue-light: #4da6ff;
            --color-primary-blue-dark: #0056b3;
            --color-secondary-green: #28A745;
            --color-secondary-green-light: #34ce57;
            --color-secondary-green-dark: #1e7e34;
            --color-light: #F8F9FA;
            --color-dark: #343A40;
            --color-text: #495057;
            --color-card-bg: #FFFFFF;
            --color-shadow: rgba(0, 0, 0, 0.1);
            --color-danger: #DC3545;
            --color-danger-light: #e4606d;
            --color-warning: #FFC107;
            --color-warning-light: #ffce3a;
            --font-family-primary: 'Poppins', sans-serif;
            --border-radius-base: 12px;
            --transition-speed: 0.4s;
            --animation-duration: 0.5s;
        }

        /* --- 2. ANTI-OVERFLOW & GLOBAL RESET --- */
        html, body { 
            width: 100%; 
            margin: 0; 
            padding: 0; 
            padding-top: 100px;
            overflow-x: hidden; 
            position: relative; 
            box-sizing: border-box; 
            font-family: var(--font-family-primary); 
            line-height: 1.6;
            color: var(--color-text); 
            background: linear-gradient(135deg, #f5f7fa 0%, #e4edf5 100%);
            min-height: 100vh;
            display: flex; 
            flex-direction: column;
        }
        *, *:before, *:after { box-sizing: inherit; }
        * { margin: 0; padding: 0; }

        .container { 
            max-width: 1200px; 
            margin: 0 auto; 
            padding: 1rem; 
            flex-grow: 1; 
        }
        section { 
            padding: 2rem 0; 
        }
        a { 
            text-decoration: none; 
            color: var(--color-primary-blue); 
            transition: all var(--transition-speed); 
        }
        a:hover { 
            color: var(--color-secondary-green); 
        }
        h1, h2, h3, h4 { 
            color: var(--color-dark); 
            margin-bottom: 1rem; 
            position: relative;
        }
        
        h2 {
            display: inline-block;
            padding-bottom: 0.5rem;
        }
        
        h2::after {
            content: '';
            position: absolute;
            left: 0;
            bottom: 0;
            width: 60px;
            height: 4px;
            background: linear-gradient(90deg, var(--color-primary-blue), var(--color-secondary-green));
            border-radius: 2px;
        }

        /* --- NAVBAR MATCHING HOMEPAGE WITH STICKY HEADER --- */
        #navbar { 
            background: linear-gradient(135deg, var(--color-primary-blue) 0%, var(--color-primary-blue-dark) 100%);
            color: var(--color-light); 
            padding: 0.8rem 1.5rem; 
            display: flex; 
            justify-content: space-between; 
            align-items: center; 
            box-shadow: 0 4px 12px rgba(0, 123, 255, 0.2);
            z-index: 9999; 
            position: fixed; 
            height: 80px;
            top: 0;
            left: 0;
            right: 0;
            width: 100%;
        }
        .logo { 
            font-size: 1.4rem; /* Slightly smaller */
            font-weight: 700; 
            color: var(--color-light); 
            display: flex; 
            align-items: center; 
            gap: 0.75rem; 
            transition: transform var(--transition-speed);
        }
        .logo-img { 
            height: 70px; 
            width: auto; 
        }
        .nav-links { 
            display: flex; 
            align-items: center;
        }
        .nav-links a { 
            color: var(--color-light); 
            margin-left: 0.75rem; 
            padding: 0.5rem 0.75rem; 
            font-weight: 500; 
            transition: all var(--transition-speed); 
            border-radius: 8px; 
            position: relative;
            overflow: hidden;
            font-size: 0.9rem; 
            display: flex;
            align-items: center;
            gap: 0.4rem; 
            white-space: nowrap;
        }
        
        .nav-links a::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: left 0.7s ease;
        }
        
        .nav-links a:hover::before {
            left: 100%;
        }
        
        .nav-links a:hover, .nav-links a.active { 
            background: rgba(255, 255, 255, 0.1);
            transform: translateY(-2px);
            box-shadow: 0 3px 6px rgba(0,0,0,0.1);
        }
        .mobile-menu-btn { 
            display: none; 
            background: none; 
            border: none; 
            color: var(--color-light); 
            font-size: 1.3rem; 
            cursor: pointer; 
            transition: transform var(--transition-speed);
            padding: 0.3rem;
        }
        .mobile-menu-btn:hover {
            transform: scale(1.1);
        }

        /* Add padding to main to account for fixed navbar */
        main {
            margin-top: 20px;
            padding-top: 0;
        }

        /* --- ENHANCED GRID SYSTEM - 5 PC / 2 MOBILE --- */
        .card-grid { 
            display: grid; 
            gap: 20px; 
            margin-top: 1.5rem; 
            width: 100%; 
        }
        @media (min-width: 1024px) { 
            .card-grid { 
                grid-template-columns: repeat(5, 1fr); 
            } 
        }
        @media (max-width: 1023px) { 
            .card-grid { 
                grid-template-columns: repeat(2, 1fr); 
            } 
        }
        @media (max-width: 480px) { 
            .card-grid { 
                grid-template-columns: 1fr; 
            } 
        }

        /* --- ENHANCED TEST CARD DESIGN --- */
        .card { 
            background: linear-gradient(145deg, var(--color-card-bg) 0%, #f8f9fa 100%);
            padding: 1.5rem; 
            border-radius: var(--border-radius-base); 
            box-shadow: 0 6px 20px var(--color-shadow); 
            height: 100%; 
            display: flex; 
            flex-direction: column; 
            justify-content: space-between; 
            border-left: 5px solid var(--color-secondary-green);
            transition: all var(--transition-speed);
            position: relative;
            overflow: hidden;
        }
        
        .card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: linear-gradient(90deg, var(--color-primary-blue), var(--color-secondary-green));
            transform: translateX(-100%);
            transition: transform var(--transition-speed);
        }
        
        .card:hover::before {
            transform: translateX(0);
        }
        
        .card:hover { 
            transform: translateY(-8px) scale(1.02); 
            box-shadow: 0 12px 30px rgba(0, 123, 255, 0.15); 
        }
        
        .test-card { 
            border-left: 5px solid var(--color-secondary-green); 
        }
        .test-card h4 { 
            color: var(--color-primary-blue); 
            font-size: 1rem; 
            height: 3.2rem; 
            overflow: hidden; 
            margin-bottom: 8px; 
            line-height: 1.4; 
            font-weight: 600;
        }

        /* --- ENHANCED DEPENDENT FILTERS --- */
        .filters-section { 
            background: linear-gradient(145deg, var(--color-card-bg) 0%, #f8f9fa 100%);
            padding: 1.5rem; 
            border-radius: var(--border-radius-base); 
            box-shadow: 0 6px 20px var(--color-shadow); 
            display: grid; 
            grid-template-columns: repeat(4, 1fr);
            gap: 20px; 
            margin-bottom: 2rem; 
            border-left: 4px solid var(--color-primary-blue);
            position: relative;
            overflow: hidden;
        }
        
        .filters-section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: linear-gradient(90deg, var(--color-primary-blue), var(--color-secondary-green));
            transform: translateX(-100%);
            transition: transform var(--transition-speed);
        }
        
        .filters-section:hover::before {
            transform: translateX(0);
        }
        
        .filter-group { 
            flex: 1; 
            min-width: 0; 
        }
        .filter-group label { 
            font-weight: 600; 
            display: block; 
            margin-bottom: 8px; 
            font-size: 0.95rem; 
            color: var(--color-dark);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        .filter-group select, .filter-group input { 
            width: 100%; 
            padding: 0.85rem; 
            border: 2px solid #e0e0e0; 
            border-radius: 8px; 
            font-size: 0.95rem; 
            cursor: pointer; 
            font-family: inherit; 
            transition: all var(--transition-speed);
            background: var(--color-card-bg);
        }

        /* --- ENHANCED BUTTONS --- */
        .button { 
            display: block; 
            padding: 0.75rem 1rem; 
            border-radius: 8px; 
            font-weight: 600; 
            cursor: pointer; 
            text-align: center; 
            border: 2px solid transparent; 
            font-size: 0.85rem; 
            width: 100%; 
            margin-top: 8px; 
            text-decoration: none; 
            transition: all var(--transition-speed);
            position: relative;
            overflow: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
        }
        
        .button::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.3);
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }
        
        .button:hover::before {
            width: 200px;
            height: 200px;
        }
        
        .primary-button { 
            background: linear-gradient(135deg, var(--color-secondary-green) 0%, var(--color-secondary-green-dark) 100%);
            color: white; 
            box-shadow: 0 4px 12px rgba(40, 167, 69, 0.3);
        }
        
        .primary-button:hover { 
            transform: translateY(-3px);
            box-shadow: 0 6px 18px rgba(40, 167, 69, 0.4);
            background: linear-gradient(135deg, var(--color-secondary-green-light) 0%, var(--color-secondary-green) 100%);
        }
        
        .secondary-button { 
            background: linear-gradient(135deg, var(--color-light) 0%, #e9ecef 100%);
            color: var(--color-primary-blue); 
            border-color: var(--color-primary-blue);
            box-shadow: 0 4px 12px rgba(0, 123, 255, 0.15);
        }
        
        .secondary-button:hover { 
            background: linear-gradient(135deg, var(--color-primary-blue) 0%, var(--color-primary-blue-dark) 100%);
            color: var(--color-light); 
            transform: translateY(-3px);
            box-shadow: 0 6px 18px rgba(0, 123, 255, 0.25);
        }

        #timer-display {
            font-weight: bold;
            color: white;
            background: linear-gradient(135deg, var(--color-danger) 0%, var(--color-danger-light) 100%);
            padding: 10px 20px;
            border-radius: 30px;
            border: 2px solid white;
            box-shadow: 0 4px 15px rgba(220, 53, 69, 0.3);
            display: inline-flex;
            align-items: center;
            gap: 0.75rem;
            margin-bottom: 15px;
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        /* --- ENHANCED FULL SCREEN MODAL --- */
        .modal { 
            display: none; 
            position: fixed; 
            z-index: 2000; 
            left: 0; 
            top: 0; 
            width: 100%; 
            height: 100%; 
            background: linear-gradient(135deg, rgba(0, 0, 0, 0.95), rgba(0, 0, 0, 0.85));
            backdrop-filter: blur(10px); 
            overflow-y: auto; 
            animation: fadeIn 0.3s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        .modal-content { 
            background: linear-gradient(145deg, var(--color-card-bg) 0%, #f8f9fa 100%);
            margin: 20px auto; 
            padding: 30px; 
            border-radius: 16px; 
            width: 98%; 
            max-width: 1200px; 
            position: relative; 
            min-height: 95vh;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.1);
            animation: slideUp 0.4s ease;
        }
        
        @keyframes slideUp {
            from { transform: translateY(50px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        
        .close-btn { 
            position: absolute; 
            top: 15px; 
            right: 25px; 
            color: var(--color-dark); 
            font-size: 35px; 
            font-weight: bold; 
            cursor: pointer; 
            z-index: 10; 
            line-height: 1; 
            transition: color var(--transition-speed);
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
        }
        
        .close-btn:hover { 
            color: var(--color-danger);
            background: rgba(0, 0, 0, 0.05);
        }
        
        .mcq-question { 
            padding: 1.75rem; 
            border: 1px solid #e9ecef; 
            border-radius: 12px; 
            margin-bottom: 1.5rem; 
            background: linear-gradient(145deg, #ffffff, #f8f9fa);
            transition: all var(--transition-speed);
            border-left: 4px solid var(--color-primary-blue);
        }
        
        .mcq-question:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }
        
        .mcq-option { 
            margin: 12px 0; 
        }
        .mcq-option label { 
            display: block; 
            padding: 14px; 
            border: 2px solid #e9ecef; 
            border-radius: 8px; 
            cursor: pointer; 
            font-size: 0.95rem; 
            transition: all 0.3s;
            background: white;
        }
        
        .mcq-option label:hover { 
            background: linear-gradient(135deg, rgba(0, 123, 255, 0.05), rgba(40, 167, 69, 0.05));
            border-color: var(--color-primary-blue); 
            transform: translateX(5px);
        }
        
        .mcq-option input[type="radio"]:checked + span {
            font-weight: 600;
            color: var(--color-primary-blue);
        }

        .correct-ans { 
            background: linear-gradient(135deg, #d4edda, #c3e6cb) !important; 
            border-color: #28a745 !important; 
            color: #155724;
            animation: correctPulse 1.5s ease;
        }
        
        @keyframes correctPulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.02); }
        }
        
        .wrong-ans { 
            background: linear-gradient(135deg, #f8d7da, #f5c6cb) !important; 
            border-color: #dc3545 !important; 
            color: #721c24;
            animation: shake 0.5s ease;
        }
        
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }

        #result-summary {
            background: linear-gradient(135deg, #ffffff, #f8f9fa);
            border-radius: 16px;
            padding: 3rem;
            border-left: 4px solid var(--color-secondary-green);
            animation: fadeIn 0.5s ease;
        }
        
        #result-summary .fa-award {
            animation: float 3s ease-in-out infinite;
            background: linear-gradient(135deg, var(--color-primary-blue), var(--color-secondary-green));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-15px); }
        }

        /* --- NEW PERCENTAGE SELECTOR DESIGN --- */
        .pct-selector {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 10px;
            margin: 20px 0;
        }
        .pct-btn {
            border: 2px solid var(--color-primary-blue);
            background: white;
            color: var(--color-primary-blue);
            padding: 12px;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: 0.3s;
        }
        .pct-btn.active {
            background: var(--color-primary-blue);
            color: white;
            box-shadow: 0 4px 10px rgba(0,123,255,0.3);
        }

        footer { 
            background: linear-gradient(135deg, var(--color-primary-blue-dark) 0%, var(--color-primary-blue) 100%);
            color: var(--color-light); 
            padding: 2rem 1rem 0; 
            margin-top: 3rem; 
            position: relative;
        }
        
        footer::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, var(--color-secondary-green), var(--color-primary-blue-light));
        }
        
        .footer-top { 
            display: flex; 
            justify-content: space-between; 
            align-items: center; 
            padding-bottom: 1.5rem; 
            border-bottom: 1px solid rgba(255, 255, 255, 0.15); 
            gap: 1rem; 
        }
        .footer-logo .logo-img { 
            height: 80px; 
            filter: drop-shadow(0 2px 4px rgba(0,0,0,0.2));
        }
        .footer-links { 
            display: flex; 
            gap: 1.5rem; 
        }
        .footer-links a { 
            color: var(--color-light); 
            font-weight: 500; 
            transition: all var(--transition-speed); 
            padding: 0.5rem;
            border-radius: 4px;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        .footer-links a:hover { 
            color: var(--color-secondary-green); 
            background: rgba(255, 255, 255, 0.1);
            transform: translateY(-2px);
        }
        .social-icons a { 
            color: var(--color-light); 
            font-size: 1.5rem; 
            margin-left: 1rem; 
            transition: all var(--transition-speed);
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.1);
        }
        .social-icons a:hover { 
            color: var(--color-secondary-green); 
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-3px) scale(1.1);
        }
        .footer-bottom { 
            text-align: center; 
            padding: 1.5rem 0; 
            opacity: 0.8;
        }
        @media (max-width: 992px) {
            .nav-links a {
                font-size: 0.85rem; /* Even smaller on medium screens */
                padding: 0.4rem 0.6rem;
                margin-left: 0.5rem;
                gap: 0.3rem;
            }
            
            .nav-links a i {
                font-size: 0.85rem;
            }
            
            .logo {
                font-size: 1.3rem;
            }
            
            .logo-img {
                height: 45px;
            }
        }
        
        @media (max-width: 768px) {
            #navbar {
                padding: 0.6rem 1rem;  /* Reduced mobile padding */
            } }
            
            .nav-links { 
                display: none; 
                flex-direction: column; 
                width: 100%; 
                position: absolute; 
                top: 60px; /* Adjusted for smaller navbar */
                left: 0; 
                background: linear-gradient(135deg, var(--color-primary-blue-dark) 0%, var(--color-primary-blue) 100%);
                box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2); 
                padding: 0.75rem 0; /* Reduced padding */
                border-radius: 0 0 var(--border-radius-base) var(--border-radius-base);
            }
            
            .nav-links.active { 
                display: flex; 
            }
            
            .nav-links a { 
                margin: 0.3rem 0.75rem; /* Reduced margin */
                padding: 0.75rem; /* Reduced padding */
                text-align: center; 
                width: calc(100% - 1.5rem); 
                border-bottom: none; 
                border-radius: var(--border-radius-base); 
                font-size: 0.9rem;
                justify-content: center;
                gap: 0.5rem;
            }
            
            .nav-links a i {
                font-size: 0.95rem;
            }
            
            .mobile-menu-btn { 
                display: block; 
                padding: 0.3rem; /* Smaller padding */
                font-size: 1.1rem; /* Smaller icon */
            }
            
            .mobile-menu-btn:hover {
                transform: scale(1.05);
            }
            
            .footer-top { 
                flex-direction: column; 
                text-align: center; 
            }
            
            .footer-links { 
                flex-direction: column; 
                gap: 0.75rem; 
                margin: 1rem 0;
            }
            
            .social-icons { 
                margin-top: 1rem; 
            }
            
            .hero-section h1 {
                font-size: 2rem;
            }
            
            .exam-grid, .province-grid {
                grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            }
        }
        
        @media (max-width: 480px) {
            #navbar {
                padding: 0.5rem 0.75rem;
            }
            
            .logo {
                font-size: 1.2rem;
                gap: 0.5rem;
            }
            
            .logo-img {
                height: 40px;
            }
            
            .hero-section {
                padding: 3rem 1rem;
            }
            
            .hero-section h1 {
                font-size: 1.75rem;
            }
            
            .card {
                padding: 1.25rem;
            }
            
            .mobile-menu-btn {
                font-size: 1rem;
            }
        }

        .hidden { 
            display: none !important; 
        }
        
        .text-center { 
            text-align: center; 
        }
    </style>
</head>
<body>
    
<header>
    <nav id="navbar">
        <div class="logo">
            <img src="assets/images/logo.png" alt="Dani Medico Logo" class="logo-img">
            Dani Medico
        </div>
        <div class="nav-links" id="navLinks">
            <a href="index.html"><i class="fas fa-home"></i> Home</a>
            <a href="dashboard.html"><i class="fas fa-tachometer-alt"></i> Dashboard</a>
            <a href="lectures.html"><i class="fas fa-video"></i> Books</a>
            <a href="notes.html"><i class="fas fa-book-open"></i> Notes</a>
            <a href="tests.html" class="active"><i class="fas fa-pencil-alt"></i> Tests</a>
            <a href="past-papers.html"><i class="fas fa-file-alt"></i> Papers</a>
            <a href="announcements.html"><i class="fas fa-bullhorn"></i> News</a>
        </div>
        <button class="mobile-menu-btn" onclick="mobileMenuToggle()">
            <i class="fas fa-bars"></i>
        </button>
    </nav>
</header>

<main class="container">
    <h2><i class="fas fa-pencil-alt"></i> Practice Tests</h2>
    <section class="filters-section card">
        <div class="filter-group">
            <label><i class="fas fa-map-marker-alt"></i> Province:</label>
            <select id="filter-province" onchange="updateExams()">
                <option value="all">All Provinces</option>
                <option value="Sindh">Sindh</option>
                <option value="Punjab">Punjab</option>
                <option value="KPK">KPK</option>
                <option value="Balochistan">Balochistan</option>
                <option value="Islamabad">Islamabad</option>
            </select>
        </div>
        <div class="filter-group">
            <label><i class="fas fa-clipboard-list"></i> Exam:</label>
            <select id="filter-exam" onchange="updateSubjects()">
                <option value="all">All Exams</option>
            </select>
        </div>
        <div class="filter-group">
            <label><i class="fas fa-book"></i> Subject:</label>
            <select id="filter-subject" onchange="updateChapters()">
                <option value="all">All Subjects</option>
            </select>
        </div>
        <div class="filter-group">
            <label><i class="fas fa-layer-group"></i> Chapter:</label>
            <select id="filter-chapter" onchange="loadTests()">
                <option value="all">All Chapters</option>
            </select>
        </div>
    </section>

    <div id="tests-container" class="card-grid"></div>
    <p id="no-content-message" class="hidden text-center">No tests found for this selection.</p>
</main>

<div id="configModal" class="modal">
    <div class="modal-content" style="max-width: 500px; min-height: auto;">
        <span class="close-btn" onclick="closeModal('configModal')">&times;</span>
        <h3 class="text-center" style="color: var(--color-primary-blue);"><i class="fas fa-user-edit"></i> Student Registration</h3>
        <p class="text-center" style="font-size: 0.9rem; margin-bottom: 20px;">Enter your details to proceed with the test.</p>
        
        <form id="details-form" onsubmit="handleDetailsSubmit(event)">
            <div class="filter-group" style="margin-bottom: 15px;">
                <label>Name:</label>
                <input type="text" id="user-name" required placeholder="Full Name">
            </div>
            <div class="filter-group" style="margin-bottom: 15px;">
                <label>City:</label>
                <input type="text" id="user-city" required placeholder="City Name">
            </div>
            <div class="filter-group" style="margin-bottom: 15px;">
                <label>WhatsApp NO:</label>
                <input type="tel" id="user-whatsapp" required placeholder="03001234567">
            </div>
            
            <label style="font-weight:600; display: block; margin-top: 15px;">Select Test Length:</label>
            <div class="pct-selector">
                <button type="button" class="pct-btn" onclick="setPercentage(0.25, this)">25%</button>
                <button type="button" class="pct-btn" onclick="setPercentage(0.50, this)">50%</button>
                <button type="button" class="pct-btn" onclick="setPercentage(0.75, this)">75%</button>
                <button type="button" class="pct-btn active" id="default-pct" onclick="setPercentage(1.0, this)">Full</button>
            </div>

            <button type="submit" class="button primary-button" style="height: 50px; font-size: 1.1rem; margin-top: 20px;">
                Start Test <i class="fas fa-chevron-right"></i>
            </button>
        </form>
    </div>
</div>

<div id="testModal" class="modal">
    <div class="modal-content">
        <span class="close-btn" onclick="closeModal('testModal')">&times;</span>
        <h3 id="test-modal-title">Interactive Quiz</h3>
        
        <div id="timer-container" class="text-center">
            <div id="timer-display"><i class="fas fa-clock"></i> Time Left: <span id="time-left">00:00</span></div>
        </div>

        <hr style="margin: 15px 0; opacity: 0.1;">
        
        <form id="mcq-form" onsubmit="submitTest(event)">
            <div id="mcq-questions"></div>
            <button type="submit" id="submit-btn" class="button primary-button" style="height: 55px; font-size: 1.1rem; margin-top: 2rem;">
                Submit Test
            </button>
        </form>

        <div id="review-actions" class="hidden" style="margin-bottom: 20px;">
            <button class="button secondary-button" onclick="backToResults()" style="max-width: 200px;">
                <i class="fas fa-arrow-left"></i> Back to Results
            </button>
        </div>

        <div id="result-summary" class="hidden" style="text-align: center; padding: 2rem;">
            <i class="fas fa-award floating-icon" style="font-size: 4rem;"></i>
            <h2 style="margin-top: 1rem;">Test Completed!</h2>
            <p style="font-size: 1.2rem; margin: 10px 0;">Score: <strong id="result-percentage" style="color: var(--color-primary-blue);"></strong></p>
            <p>Correct Answers: <span id="result-correct"></span> / <span id="result-total"></span></p>
            
            <div style="display: flex; gap: 10px; flex-wrap: wrap; margin-top: 20px; justify-content: center;">
                <button class="button secondary-button" onclick="checkTest()">
                    <i class="fas fa-search"></i> Check Test
                </button>
                <button class="button primary-button" onclick="downloadTestPDF()" style="background: linear-gradient(135deg, var(--color-danger) 0%, var(--color-danger-light) 100%); border: none;">
                    <i class="fas fa-file-pdf"></i> Download Paper
                </button>
            </div>
            <button class="button primary-button" onclick="closeModal('testModal')" style="max-width: 250px; margin: 20px auto;">Close and Continue</button>
        </div>
    </div>
</div>
<footer>
        <div class="footer-top container">
            <div class="footer-links">
                <a href="about.html"><i class="fas fa-info-circle"></i> About Us</a>
                <a href="contact.html"><i class="fas fa-envelope"></i> Contact</a>
                <a href="https://wa.me/923001234567" target="_blank"><i class="fab fa-whatsapp"></i> WhatsApp</a>
            </div>
            <div class="footer-logo">
                <img src="assets/images/logo.png" alt="Dani Medico Logo" class="logo-img">
            </div>
            <div class="social-icons">
                <a href="#" target="_blank" title="Facebook"><i class="fab fa-facebook-f"></i></a>
                <a href="https://wa.me/923001234567" target="_blank" title="WhatsApp"><i class="fab fa-whatsapp"></i></a>
                <a href="#" target="_blank" title="Instagram"><i class="fab fa-instagram"></i></a>
                <a href="#" target="_blank" title="YouTube"><i class="fab fa-youtube"></i></a>
            </div>
        </div>
        <div class="footer-bottom">
            <p><i class="fas fa-heart" style="color: #ff4757;"></i> &copy; 2025 Dani Medico. Empowering Future Doctors. All rights reserved.</p>
        </div>
    </footer>
<script>
    const mdcatExams = ["MDCAT", "BSN", "NUMS", "AKU", "AFNS"];
    const examSubjects = {
        "all": ["All Subjects"],
        "MDCAT": ["Biology", "Chemistry", "Physics", "English", "Logical Reasoning"],
        "BSN": ["Biology", "Chemistry", "Physics", "English", "Logical Reasoning"],
        "NUMS": ["Biology", "Chemistry", "Physics", "English", "Logical Reasoning"],
        "AKU": ["Biology", "Chemistry", "Physics", "English", "Logical Reasoning"],
        "AFNS": ["Biology", "Chemistry", "Physics", "English", "Logical Reasoning"]
    };

    const examSubjectChapters = {
        "MDCAT_Biology": ["1. ACELLULAR LIFE", "2. BIOENERGETICS", "3. BIOLOGICAL MOLECULES", "4. CELL STRUCTURE & FUNCTION", "5. COORDINATION & CONTROL", "6. ENZYMES", "7. EVOLUTION", "8. REPRODUCTION", "9. SUPPORT & MOVEMENT", "10. INHERITENCE", "11. CIRCULATION", "12. IMMUNITY", "13. RESPIRATION", "14. DIGESTION", "15. HOMEOSTASIS", "16. BIOTECHNOLOGY"],
        "MDCAT_Chemistry": ["1. INTRO TO FUNDAMENTAL CONCEPTS OF CHEMISTRY", "2. ATOMIC STRUCTURE", "3. GASES", "4. LIQUIDS", "5. SOLIDS", "6. CHEMICAL EQUILIBRIUM", "7. REACTION KINETICS", "8. THERMO-CHEMISTRY & ENERGETICS OF CHEMICAL REACTIONS", "9. ELECTROCHEMISTRY", "10. CHEMICAL BONDING", "11.S & P Block Elements", "12.TRANSITION ELEMENTS", "13.FUNDAMENTAL PRINCIPLES OF ORGANIC CHEMISTRY", "14.CHEMISTRY OF HYDROCARBONS", "15.ALKYL HALIDES", "16.ALCOHOLS & PHENOLS", "17.ALDEHYDES & KETONES", "18. CARBOXYLIC ACIDS", "19. MACROMOLECULES"],
        "MDCAT_Physics": ["1.VECTORS & EQUILIBRIUM", "2.FORCE & MOTION", "3.WORK & ENERGY", "4.ROTATIONAL & CIRCULAR MOTION", "5.FLUID DYNAMICS", "6.WAVES", "7.THERMODYNAMICS", "8.ELECTROSTATICS", "9.CURRENT ELECTRICITY", "10.ELECTROMAGNETISM", "11.ELECTROMAGNETIC INDUCTION", "12.ALTERNATING CURRENT", "13.ELECTRONICS", "14.DAWN OF MODERN PHYSICS", "15.ATOMIC SPECTRA", "16.NUCLEAR PHYSICS"],
        "MDCAT_English": ["1. GRAMMAR FUNDAMENTALS", "2. VOCABULARY BUILDING", "3. READING COMPREHENSION"],
        "MDCAT_Logical_Reasoning": ["1. ANALYTICAL REASONING", "2. LOGICAL DEDUCTION", "3. PATTERN RECOGNITION", "4. VERBAL REASONING", "5. NON-VERBAL REASONING", "6. CRITICAL THINKING"],
        "BSN_Biology": ["1. HUMAN ANATOMY", "2. HUMAN PHYSIOLOGY", "3. BIOCHEMISTRY", "4. MICROBIOLOGY", "5. PATHOLOGY", "6. PHARMACOLOGY", "7. NUTRITION", "8. GENETICS", "9. IMMUNOLOGY", "10. FIRST AID", "11. NURSING FUNDAMENTALS", "12. COMMUNITY HEALTH"],
        "BSN_Chemistry": ["1. BASIC CHEMISTRY", "2. ORGANIC CHEMISTRY", "3. BIOCHEMISTRY", "4. MEDICINAL CHEMISTRY", "5. ANALYTICAL CHEMISTRY", "6. ENVIRONMENTAL CHEMISTRY"],
        "BSN_Physics": ["1. BIOPHYSICS", "2. MEDICAL PHYSICS", "3. RADIATION PHYSICS", "4. THERMODYNAMICS", "5. FLUID MECHANICS", "6. ELECTRICITY IN MEDICINE"],
        "BSN_English": ["1. MEDICAL TERMINOLOGY", "2. COMMUNICATION SKILLS"],
        "BSN_Logical_Reasoning": ["1. PROBLEM SOLVING", "2. DECISION MAKING", "3. CLINICAL REASONING", "4. ETHICAL REASONING"],
        "NUMS_Biology": ["1. CELL STRUCTURE", "2. GENETICS", "3. HUMAN PHYSIOLOGY", "4. PLANT PHYSIOLOGY", "5. ECOLOGY", "6. EVOLUTION", "7. MICROBIOLOGY", "8. BIOTECHNOLOGY"],
        "NUMS_Chemistry": ["1. PHYSICAL CHEMISTRY", "2. INORGANIC CHEMISTRY", "3. ORGANIC CHEMISTRY", "4. ENVIRONMENTAL CHEMISTRY", "5. ANALYTICAL CHEMISTRY"],
        "NUMS_Physics": ["1. MECHANICS", "2. THERMODYNAMICS", "3. ELECTROMAGNETISM", "4. OPTICS", "5. MODERN PHYSICS", "6. MEDICAL PHYSICS"],
        "NUMS_English": ["1. ENGLISH PROFICIENCY", "2. COMPREHENSION", "3. WRITING SKILLS"],
        "NUMS_Logical_Reasoning": ["1. QUANTITATIVE REASONING", "2. VERBAL REASONING", "3. ABSTRACT REASONING"],
        "AKU_Biology": ["1-INTRODUCTION OF BIOLOGY","2-BIOLOGICAL MOLECULES","3-ENZYMES","4-THE CELL","5-CLASSIFICATION AND ACELLULAR LIFE","6-KINGDOM PROKARYOTAE","7-KINGDOM PROTISTA (PROTOCTISTA)","8-KINGDOM FUNGI","9-KINGDOM PLANTAE","10-KINGDOM ANIMALIA","11-BIOENERGETICS","12-NUTRITION","13-GASEOUS EXCHANGE","14-TRANSPORT","15-HOMEOSTASIS","16-SUPPORT AND MOVEMENT","17-COORDINATION AND CONTROL","18-REPRODUCTION","19-GROWTH AND DEVELOPMENT","20-CHROMOSOMES AND DNA","21-CELL CYCLE","22-VARIATION AND GENETICS","23-BIOTECHNOLOGY","24-EVOLUTION","25-ECOSYSTEM","26-SOME MAJOR ECOSYSTEMS","27-MAN AND HIS ENVIRONMENT"],
        "AKU_Chemistry": ["1- STOICHIOMETRY","2- ATOMIC STRUCTURE","3- THEORIES OF COVALENT BONDING AND SHAPE OF MOLECULES","4- STATES OF MATTER I: GASES","5- STATES OF MATTER II: LIQUIDS","6- STATES OF MATTER III: SOLIDS","7- CHEMICAL EQUILIBRIUM","8- ACIDS, BASES AND SALTS","9- CHEMICAL KINETICS","10- SOLUTIONS AND COLLOIDS","11- THERMOCHEMISTRY","12- ELECTROCHEMISTRY","13- S- AND P-BLOCK ELEMENTS","14- D- AND F-BLOCK ELEMENTS","15- ORGANIC COMPOUNDS","16- HYDROCARBONS","17- ALKYL HALIDES AND AMINES","18- ALCOHOLS, PHENOLS AND ETHERS","19- CARBONYL COMPOUND I: ALDEHYDES AND KETONES","20- CARBONYL COMPOUND II: CARBOXYLIC ACIDS AND FUNCTIONAL DERIVATIVES","21- BIOCHEMISTRY","22- INDUSTRIAL CHEMISTRY","23- ENVIRONMENTAL CHEMISTRY","24- ANALYTICAL CHEMISTRY"],
        "AKU_Physics": ["1- STOICHIOMETRY","2- ATOMIC STRUCTURE","3- THEORIES OF COVALENT BONDING AND SHAPE OF MOLECULES","4- STATES OF MATTER I: GASES","5- STATES OF MATTER II: LIQUIDS","6- STATES OF MATTER III: SOLIDS","7- CHEMICAL EQUILIBRIUM","8- ACIDS, BASES AND SALTS","9- CHEMICAL KINETICS","10- SOLUTIONS AND COLLOIDS","11- THERMOCHEMISTRY","12- ELECTROCHEMISTRY","13- S- AND P-BLOCK ELEMENTS","14- D- AND F-BLOCK ELEMENTS","15- ORGANIC COMPOUNDS","16- HYDROCARBONS","17- ALKYL HALIDES AND AMINES","18- ALCOHOLS, PHENOLS AND ETHERS","19- CARBONYL COMPOUND I: ALDEHYDES AND KETONES","20- CARBONYL COMPOUND II: CARBOXYLIC ACIDS AND FUNCTIONAL DERIVATIVES","21- BIOCHEMISTRY","22- INDUSTRIAL CHEMISTRY","23- ENVIRONMENTAL CHEMISTRY","24- ANALYTICAL CHEMISTRY"],
        "AKU_English": ["1. ACADEMIC ENGLISH", "2. MEDICAL COMMUNICATION", "3. RESEARCH WRITING"],
        "AKU_Logical_Reasoning": ["1. CRITICAL ANALYSIS", "2. PROBLEM SOLVING", "3. DECISION MAKING"],
        "AFNS_Biology": ["1. BASIC BIOLOGY", "2. HUMAN ANATOMY", "3. PHYSIOLOGY", "4. MICROBIOLOGY", "5. FIRST AID"],
        "AFNS_Chemistry": ["1. BASIC CHEMISTRY", "2. BIOCHEMISTRY", "3. PHARMACOLOGY"],
        "AFNS_Physics": ["1. BASIC PHYSICS", "2. MEDICAL PHYSICS"],
        "AFNS_English": ["1. MILITARY ENGLISH", "2. COMMUNICATION SKILLS"],
        "AFNS_Logical_Reasoning": ["1. ANALYTICAL THINKING", "2. DECISION MAKING"]
    };

    const testsData = [
        { 
    id: 'T1', 
    title: 'BIOLOGY SINDH MDCAT', 
    subject: 'Biology', 
    chapter: '1. ACELLULAR LIFE', 
    exam: 'MDCAT', 
    province: 'Sindh', 
    mcqs: [
        { q: "Charles Chamberland's porcelain filter (pore size 0.1 Âµm) was crucial in virus discovery because it:", options: ["Killed all bacteria in infected samples", "Allowed visualization of viruses under light microscopy", "Demonstrated an infectious agent smaller than bacteria passed through", "Isolated pure viral nucleic acid for the first time"], answer: 2 }, // [cite: 3486, 3491]
        { q: "Martinus Beijerinck described the causative agent of TMD as a 'contagious living fluid' because he observed:", options: ["Its ability to be crystallized like a chemical", "It replicated only inside living host cells", "The filtered infectious agent could reproduce in new hosts", "It contained DNA visible under the electron microscope"], answer: 2 }, // [cite: 3492, 3493]
        { q: "A key non-living characteristic preventing viruses from being classified as true living organisms is their:", options: ["Ability to undergo mutation", "Dependence on host cells for replication", "Capacity to crystallize and remain inert indefinitely", "Possession of their own nucleic acid genome"], answer: 2 }, // [cite: 3494, 3495]
        { q: "Which feature makes non-enveloped viruses like Rhinovirus more resistant to environmental stress compared to enveloped viruses?", options: ["Presence of a double-stranded DNA genome", "Icosahedral capsid symmetry", "Absence of a lipid membrane", "Smaller overall size"], answer: 2 }, // [cite: 3515, 3516]
        { q: "The glyco-protein spikes found on some viral envelopes primarily function to:", options: ["Protect the viral genome from nucleases", "Recognize and attach to specific host cell receptors", "Facilitate the formation of the crystalline structure", "Provide energy for viral entry into the host cell"], answer: 1 }, // [cite: 3516, 3517]
        { q: "According to the Baltimore classification system modified around 2018-2019, Hepatitis B virus belongs to which group?", options: ["Group I: dsDNA viruses", "Group VII: dsDNA viruses with an RNA intermediate", "Group IV: (+)ssRNA viruses", "Group VI: ssRNA-RT viruses"], answer: 1 }, // [cite: 3518, 3520]
        { q: "Positive-sense single-stranded RNA viruses (e.g., Coronavirus, Dengue) are unique because their genomic RNA:", options: ["Must first be transcribed into dsDNA by reverse transcriptase", "Can directly function as mRNA for immediate translation by host ribosomes", "Requires synthesis of a complementary RNA strand before translation", "Is integrated into the host genome before replication begins"], answer: 1 }, // [cite: 3521, 3522]
        { q: "The obligate parasitic nature of viruses fundamentally stems from their lack of:", options: ["Genetic material (DNA or RNA)", "Cellular organelles and metabolic machinery", "A protein coat (capsid)", "The ability to mutate"], answer: 1 }, // [cite: 3524, 3525]
        { q: "One mechanism viruses use to survive inside host cells is by degrading the host genome. This is exemplified by:", options: ["Bacteriophages synthesizing endonucleases to break down bacterial DNA", "HIV blocking interferon response in T-cells", "Enveloped viruses using host membrane lipids", "Prions altering protein folding in neurons"], answer: 0 }, // [cite: 3526, 3527]
        { q: "Viruses suppress the host immune response by blocking interferon signaling. Interferons are normally:", options: ["Antibodies produced by B-cells against viruses", "Proteins released by infected cells to signal the immune system", "Enzymes that directly destroy viral capsids", "Components of the complement system"], answer: 1 }, // [cite: 3529, 3530]
        { q: "Influenza and COVID-19 tend to survive longer at LOW relative humidity (20-30%) because:", options: ["Higher humidity dissolves their glycoprotein spikes", "Lower humidity makes the host more susceptible", "UV light is less effective at lower humidity", "High humidity causes lipid envelopes to absorb water and rupture"], answer: 3 }, // [cite: 3531, 3533]
        { q: "Non-enveloped viruses like Adenovirus and Rhinovirus are generally MORE resistant than enveloped viruses to:", options: ["Freezing temperatures", "Organic solvents, detergents, and sanitizers", "Drying out (desiccation)", "Low pH environments"], answer: 1 }, // [cite: 3500, 3503]
        { q: "The base plate of a T4 bacteriophage is critically important for infection because it:", options: ["Contains the viral DNA genome", "Synthesizes the enzyme lysozyme", "Has tail fibers for receptors and pins with lysozyme to penetrate the wall", "Contracts to inject the DNA"], answer: 2 }, // [cite: 3505, 3506]
        { q: "In the Lytic Cycle, the stage where the host cell's machinery is hijacked to produce phage proteins is called:", options: ["Attachment", "Penetration", "Biosynthesis", "Maturation"], answer: 2 }, // [cite: 3508, 3510]
        { q: "The enzyme 'lysozyme' plays a crucial role in the bacteriophage lytic cycle by:", options: ["Helping inject the phage DNA into the bacterium", "Breaking down the bacterial cell wall to release new phage progeny", "Replicating the phage DNA", "Assembling the capsid proteins"], answer: 1 }, // [cite: 3512, 3534]
        { q: "A key difference between the Lytic and Lysogenic cycles of bacteriophage is:", options: ["In Lysogeny, the viral DNA integrates into the host genome (prophage) without immediate killing", "Only the Lytic cycle involves attachment", "The Lysogenic cycle always results in faster cell lysis", "Reverse transcriptase is only used in Lysogeny"], answer: 0 }, // [cite: 3536, 3537]
        { q: "A prophage (in the lysogenic cycle) can be induced to enter the lytic cycle by:", options: ["Natural bacterial cell division", "Action of viral capsid proteins", "Environmental triggers like radiation damaging the host DNA", "Depletion of nutrients"], answer: 2 }, // [cite: 3539, 3541]
        { q: "Bacteriophages are valuable tools in genetic engineering primarily because they:", options: ["Can infect a wide range of bacterial species", "Can be engineered to transfer specific genes into host bacteria", "Produce large quantities of energy", "Naturally destroy all pathogenic bacteria"], answer: 1 }, // [cite: 3542, 3543]
        { q: "HIV is classified as a retrovirus because it:", options: ["Has a double-stranded DNA genome", "Uses reverse transcriptase to make DNA from its RNA genome", "Directly translates its RNA into viral proteins", "Integrates its RNA into the host genome"], answer: 1 }, // [cite: 3545, 3546]
        { q: "The glycoprotein spikes on the HIV envelope are essential for:", options: ["Protecting from UV radiation", "Binding to specific receptors (CD4) on helper T-lymphocytes", "Carrying out reverse transcription", "Packaging the viral RNA"], answer: 1 }, // [cite: 3547, 3548]
        { q: "During HIV infection, the step where viral DNA integrates into the host cell's chromosome is called:", options: ["Binding", "Fusion", "Reverse Transcription", "Integration (forming a provirus)"], answer: 3 }, // [cite: 3549, 3550]
        { q: "HIV specifically targets Helper T-lymphocytes primarily because they possess:", options: ["High nutrient concentrations", "Lack of immune response", "Specific surface protein receptors (like CD4) for binding", "The reverse transcriptase enzyme"], answer: 2 }, // [cite: 3552, 3553]
        { q: "The enzyme 'protease' is crucial in the late stages of the HIV life cycle for:", options: ["Reverse transcription", "Integrating viral DNA", "Cutting long viral protein chains into functional fragments", "Facilitating budding"], answer: 2 }, // [cite: 3555, 3557]
        { q: "A person in the asymptomatic stage of HIV infection:", options: ["Cannot transmit the virus", "Shows no signs of virus in blood tests", "May have swollen lymph glands and can still transmit the virus", "Has a completely eradicated infection"], answer: 2 }, // [cite: 3559, 3560]
        { q: "Antiretroviral Therapy (ART) for HIV works by:", options: ["Boosting Helper T-cells", "Using drugs that inhibit specific enzymes (RT, protease, integrase)", "Destroying free viral particles", "Preventing initial attachment"], answer: 1 }, // [cite: 3561]
        { q: "Transmission of HIV does NOT occur through:", options: ["Contaminated blood transfusion", "Unprotected sexual contact", "Airborne droplets from coughing", "Sharing unsterilized syringes"], answer: 2 }, // [cite: 3571, 3572]
        { q: "Hepatitis transmission via the 'fecal-oral' route is most characteristic of:", options: ["Hepatitis B and C", "Hepatitis A and E", "All types", "Only Hepatitis D"], answer: 1 }, // [cite: 3573, 3574]
        { q: "Poliovirus primarily causes paralysis by:", options: ["Destroying liver cells", "Damaging motor neurons after entering the blood/lymph system", "Integrating into muscle DNA", "Triggering cytokine storms"], answer: 1 }, // [cite: 3586]
        { q: "Cotton Leaf Curl Disease (Begomovirus) causes economic loss in Pakistan primarily by:", options: ["Killing plants instantly", "Reducing the quality and quantity of cotton fiber production", "Making plants toxic", "Preventing seed germination"], answer: 1 }, // [cite: 3587, 3588]
        { q: "The vector responsible for transmitting Cotton Leaf Curl Disease is:", options: ["Mosquito", "Tick", "Whitefly", "Aphid"], answer: 2 }, // [cite: 3590, 3591]
        { q: "Prions are unique infectious agents because they:", options: ["Contain a small ssRNA genome", "Have a complex lipid envelope", "Are composed solely of misfolded protein, lacking nucleic acid", "Replicate using host ribosomes"], answer: 2 }, // [cite: 3593, 3594]
        { q: "Which disease is associated with PRIONS?", options: ["Tuberculosis", "AIDS", "Mad Cow Disease (BSE)", "Dengue Fever"], answer: 2 }, // [cite: 3595, 3596]
        { q: "Viroids differ from viruses fundamentally because viroids:", options: ["Always have a protein coat", "Can infect animals", "Consist only of a small, circular RNA molecule", "Use reverse transcriptase"], answer: 2 }, // [cite: 3597, 3598]
        { q: "The first viroid discovered was the causative agent of:", options: ["Peach Latent Mosaic", "Avocado Sunblotch", "Potato Spindle Tuber disease", "Citrus Exocortis"], answer: 2 }, // [cite: 3600, 3601]
        { q: "Viroids only cause plant diseases because they:", options: ["Lack an adaptive immune system", "Lack machinery (capsid/envelope) to enter animal cells", "Are destroyed by skin", "Require sunlight"], answer: 1 }, // [cite: 3603, 3604]
        { q: "Which virus is CORRECTLY matched with its genomic nucleic acid type?", options: ["Ebola: dsDNA", "Measles: Negative-sense ssRNA", "Hepatitis C: dsRNA", "Herpes: ssDNA"], answer: 1 }, // [cite: 3606, 3607]
        { q: "The primary vector for transmitting Chikungunya and Dengue viruses is:", options: ["Tsetse fly", "Aedes mosquito", "Anopheles mosquito", "Sandfly"], answer: 1 }, // [cite: 3608, 3609]
        { q: "A symptom commonly associated with both Dengue and Chikungunya is:", options: ["Hemorrhagic fever", "Jaundice", "Severe joint and muscle pain", "Paralysis"], answer: 2 }, // [cite: 3610, 3611]
        { q: "Transmission of Ebola virus primarily occurs through:", options: ["Airborne droplets", "Direct contact with infected body fluids", "Fecal-oral route", "Bite of mosquitoes"], answer: 1 }, // [cite: 3612, 3613]
        { q: "The impact of Cotton Leaf Curl Virus in Pakistan since 1992 is estimated at:", options: ["Rs. 10 billion", "Rs. 50-55 billion loss", "Rs. 100 billion", "Rs. 5 billion"], answer: 1 }, // [cite: 3614, 3615]
        { q: "Ivanovsky's 1892 experiment on TMD proved that:", options: ["Bacteria cause the disease", "The infectious filtrate contained an agent smaller than bacteria", "Viruses could be seen by light microscopy", "Crystallization was possible"], answer: 1 }, // [cite: 3616, 3617]
        { q: "W.M. Stanley's 1935 crystallization of TMV demonstrated that viruses:", options: ["Are living organisms", "Behave like chemicals (non-living characteristic)", "Contain DNA", "Are only found in plants"], answer: 1 }, // [cite: 3580, 3583]
        { q: "Icosahedral capsid symmetry refers to capsomeres arranged in:", options: ["A helical coil", "20 triangular faces forming a polyhedron", "A random globular cluster", "A head-and-tail structure"], answer: 1 }, // [cite: 3618, 3619]
        { q: "The viral envelope is primarily derived from:", options: ["Self-synthesized viral lipids", "The host cell's surface membrane during budding", "Aggregation of capsomeres", "The nuclear membrane"], answer: 1 }, // [cite: 3620, 3621]
        { q: "Baltimore Group IV viruses ((+)ssRNA) are unique because their RNA can:", options: ["Immediately be transcribed to DNA", "Directly bind to host ribosomes and be translated", "Synthesize a complementary strand first", "Integrate into host DNA"], answer: 1 }, // [cite: 3622, 3625]
        { q: "Viruses degrade the host genome primarily to:", options: ["Provide nucleotides for replication", "Shut down host functions and redirect resources", "Activate immune systems", "Prevent cell division"], answer: 1 }, // [cite: 3626, 3627]
        { q: "Viruses block the interferon response to:", options: ["Enhance protein synthesis", "Prevent neighboring cells from mounting an antiviral state", "Stimulate B-cell activation", "Facilitate budding"], answer: 1 }, // [cite: 3629, 3630]
        { q: "The 'ghost' structure in T4 bacteriophage infection refers to:", options: ["The empty capsid/tail after DNA injection", "The remnants of the cell wall", "The detached base plate", "The integrated DNA"], answer: 0 }, // [cite: 3632, 3633]
        { q: "The enzyme 'integrase' is essential in the HIV life cycle for:", options: ["Reverse Transcription", "Inserting viral DNA into host chromosomes", "Cutting protein chains", "Membrane fusion"], answer: 1 }, // [cite: 3635, 3637]
        { q: "A symptom indicating progression of HIV to AIDS includes:", options: ["Short-lived fever", "Swollen lymph glands", "Opportunistic infections like TB", "HIV antibodies"], answer: 2 }, // [cite: 3639, 3640]
        { q: "Which structural component is COMMON to ALL viruses?", options: ["Lipid envelope", "Glycoprotein spikes", "Capsid protein shell", "Tail fibers"], answer: 2 }, // [cite: 3648, 3649]
        { q: "Helical capsid structure is characterized by:", options: ["20 triangular faces", "Hollow protein coils forming rods", "Spherical polyhedrons", "Complex head-tail morphology"], answer: 1 }, // [cite: 3651, 3662]
        { q: "A key difference between plant and animal viruses is that plant viruses:", options: ["Always have DNA", "Require vectors for transmission", "Cannot mutate", "Lack capsids"], answer: 1 }, // [cite: 3663, 3664]
        { q: "The modified Baltimore classification reflects:", options: ["New viral shapes", "Evolutionary relationships based on replication strategy", "Host specificity changes", "Discovery of new nucleic acids"], answer: 1 }, // [cite: 3665, 3666]
        { q: "dsRNA viruses (Group III) differ from ssRNA viruses by:", options: ["Directly translating genome", "Requiring reverse transcription", "Using complementary RNA strand as mRNA", "Integrating into host DNA"], answer: 2 }, // [cite: 3667, 3668]
        { q: "Negative-sense RNA viruses must carry which enzyme for infection?", options: ["DNA polymerase", "Reverse transcriptase", "RNA-dependent RNA polymerase", "Integrase"], answer: 2 }, // [cite: 3670, 3671]
        { q: "Hepatitis B virus is unique among DNA viruses because it:", options: ["Has an RNA intermediate", "Infects plants", "Lacks a capsid", "Is always acute"], answer: 0 }, // [cite: 3672, 3673]
        { q: "Viral envelope acquisition occurs during:", options: ["Capsid assembly", "Host cell entry", "Budding from host membrane", "Crystallization"], answer: 2 }, // [cite: 3674, 3676]
        { q: "The primary function of viral capsomeres is to:", options: ["Carry out metabolism", "Protect the genome", "Generate energy", "Move the virus"], answer: 1 }, // [cite: 3677, 3678]
        { q: "Wendell Stanley's crystallization of TMV showed viruses can behave like:", options: ["Bacteria", "Chemicals", "Cells", "Fungi"], answer: 1 }, // [cite: 3679, 3680]
        { q: "Which factor does NOT significantly affect viral environmental survival?", options: ["Temperature", "Humidity", "Light intensity", "Atmospheric pressure"], answer: 3 }, // [cite: 3681, 3682]
        { q: "At pH 5.0-5.5, most viruses are:", options: ["Activated", "Destroyed/Inactivated", "Mutated", "Integrated"], answer: 1 }, // [cite: 3683, 3685]
        { q: "The contractile sheath of T4 bacteriophage functions to:", options: ["Synthesize DNA", "Protect the head", "Force DNA into the host cell", "Recognize hosts"], answer: 2 }, // [cite: 3686, 3687]
        { q: "Bacteriophage tail fibers are analogous to animal virus:", options: ["Mitochondria", "Envelopes", "Antibodies", "Glycoprotein spikes"], answer: 3 }, // [cite: 3688, 3694]
        { q: "Lysogenic conversion refers to:", options: ["Immediate lysis", "Genome excision", "New bacterial traits from prophage genes", "Capsid mutation"], answer: 2 }, // [cite: 3695, 3696]
        { q: "Which enzyme is UNIQUE to retroviruses?", options: ["DNA polymerase", "Lysozyme", "Reverse transcriptase", "ATP synthase"], answer: 2 }, // [cite: 3699, 3701]
        { q: "HIV's gp120 glycoprotein binds specifically to:", options: ["Bacterial cell walls", "CD4 receptors", "Ribosomes", "Antibodies"], answer: 1 }, // [cite: 3704, 3705]
        { q: "The HIV provirus stage refers to:", options: ["Free particles", "Integrated viral DNA", "Budding", "Assembly"], answer: 1 }, // [cite: 3706, 3708]
        { q: "Protease inhibitors in HIV treatment prevent:", options: ["Cell entry", "Genome integration", "Protein processing (polyprotein cleavage)", "Reverse transcription"], answer: 2 }, // [cite: 3709, 3710]
        { q: "Window period in HIV infection refers to:", options: ["Asymptomatic phase", "Time before antibodies are detectable", "Final AIDS stage", "Viral dormancy"], answer: 1 }, // [cite: 3711, 3712]
        { q: "Which is NOT a transmission route for Hepatitis B?", options: ["Sexual contact", "Blood transfusion", "Contaminated food", "Placental transfer"], answer: 2 }, // [cite: 3714, 3717]
        { q: "Oral polio vaccine contains:", options: ["Killed virus", "Attenuated (weakened) virus", "Viral DNA", "Antibodies"], answer: 1 }, // [cite: 3718, 3719]
        { q: "Begomoviruses are transmitted by:", options: ["Soil fungi", "Whiteflies", "Aphids", "Nematodes"], answer: 1 }, // [cite: 3720, 3721]
        { q: "Prion diseases affect the:", options: ["Liver", "Nervous system", "Blood cells", "Lungs"], answer: 1 }, // [cite: 3723, 3724]
        { q: "Viroids primarily infect:", options: ["Animals", "Plants", "Bacteria", "Fungi"], answer: 1 }, // [cite: 3727, 3728]
        { q: "Which is a DNA virus?", options: ["Influenza", "HIV", "Herpes virus", "Dengue"], answer: 2 }, // [cite: 3730, 3732]
        { q: "Arboviruses are transmitted by:", options: ["Rodents", "Arthropods (e.g. Mosquitoes)", "Birds", "Bats"], answer: 1 }, // [cite: 3734, 3735]
        { q: "Kaposi's sarcoma in AIDS patients is caused by:", options: ["Bacteria", "Fungi", "Opportunistic virus (HHV-8)", "Prions"], answer: 2 }, // [cite: 3740, 3745]
        { q: "The primary host reservoir for Ebola is:", options: ["Mosquitoes", "Fruit Bats", "Dogs", "Birds"], answer: 1 }, // [cite: 3746, 3747]
        { q: "Which viral disease shows 'vein thickening' in plants?", options: ["Tobacco mosaic", "Cotton leaf curl", "Potato spindle tuber", "Avocado sunblotch"], answer: 1 }, // [cite: 3748, 3749]
        { q: "Viral mutations often lead to:", options: ["Increased host range", "Vaccine/Drug resistance", "Larger virion size", "Capsid crystallization"], answer: 1 }, // [cite: 3750, 3760]
        { q: "The 'eclipse phase' in viral replication refers to the period when:", options: ["Virions are assembled", "Genome is integrated", "No intact virions are detectable after uncoating", "Budding occurs"], answer: 2 }, // [cite: 3761, 3762]
        { q: "Which viral enzyme is targeted by AZT?", options: ["Integrase", "Protease", "Reverse transcriptase", "Lysozyme"], answer: 2 }, // [cite: 3763, 3766]
        { q: "Syncytia formation is characteristic of:", options: ["Bacteriophages", "HIV", "TMV", "Viroids"], answer: 1 }, // [cite: 3767, 3768]
        { q: "Which virus has a segmented genome?", options: ["HIV", "Influenza", "Rabies", "Hepatitis B"], answer: 1 }, // [cite: 3769, 3771]
        { q: "The 'burst size' refers to:", options: ["Virion diameter", "Number of progeny per infected cell", "Mutation rate", "Genome size"], answer: 1 }, // [cite: 3772, 3773]
        { q: "Satellite viruses differ from viroids by having:", options: ["A protein coat (capsid)", "DNA genome", "Lipid envelope", "Reverse transcriptase"], answer: 0 }, // [cite: 3774, 3775]
        { q: "Which is NOT a prion disease?", options: ["Scrapie", "Kuru", "Creutzfeldt-Jakob", "Dengue"], answer: 3 }, // [cite: 3776, 3777]
        { q: "The 'R0' (R-naught) value measures:", options: ["Virulence", "Transmission potential/rate", "Mortality", "Incubation period"], answer: 1 }, // [cite: 3778, 3779]
        { q: "Viral oncogenes were first discovered in:", options: ["Influenza", "HIV", "Rous sarcoma virus", "Polio"], answer: 2 }, // [cite: 766, 769]
        { q: "Interferons primarily act by:", options: ["Directly destroying viruses", "Blocking viral receptors", "Inducing antiviral proteins in neighboring cells", "Neutralizing free virions"], answer: 2 }, // [cite: 3952, 3953]
        { q: "Which virus uses antigenic drift AND shift?", options: ["HIV", "Influenza", "Rabies", "Hepatitis C"], answer: 1 }, // [cite: 3817, 3818]
        { q: "The latent period in viral growth curves precedes:", options: ["Attachment", "Genome replication", "Release of progeny", "Integration"], answer: 2 }, // [cite: 719, 723]
        { q: "Viral inclusion bodies are sites of:", options: ["Energy storage", "Viral replication/assembly", "Defective virions", "Capsid fragments"], answer: 1 }, // [cite: 735, 737]
        { q: "Which hepatitis virus requires HBV for replication?", options: ["HAV", "HCV", "HDV", "HEV"], answer: 2 }, // [cite: 3864, 3865]
        { q: "The 'Western blot' confirms HIV infection by detecting:", options: ["Viral RNA", "Viral antigens", "Specific antibodies against viral proteins", "CD4 count"], answer: 2 }, // [cite: 3870, 3871]
        { q: "Which plant virus has helical symmetry?", options: ["CaMV", "TMV", "Begomovirus", "Geminivirus"], answer: 1 }, // [cite: 4021, 4022]
        { q: "The primary determinant of viral host range is:", options: ["Capsid size", "Receptor compatibility", "Genome type", "Envelope presence"], answer: 1 }, // [cite: 4023, 4024]
        { q: "Viral plaques in culture represent:", options: ["Mutated cells", "Areas of cell lysis", "Antibody clusters", "Uninfected zones"], answer: 1 }, // [cite: 4031, 4032]
        { q: "The phenomenon where a bacteriophage carries bacterial DNA between hosts is called:", options: ["Lysogenic conversion", "Transduction", "Transformation", "Conjugation"], answer: 1 }, // [cite: 3811, 3812]
        { q: "Which viral enzyme is responsible for integrating HIV DNA into host chromosomes?", options: ["Reverse transcriptase", "Protease", "Integrase", "Lysozyme"], answer: 2 }, // [cite: 3751, 3755]
        { q: "The 'latency period' in HIV infection refers to:", options: ["Time before antibodies", "Clinical dormancy despite active viral replication", "Final AIDS stage", "Window for vaccine"], answer: 1 }, // [cite: 3756, 3781]
        { q: "Cotton Leaf Curl Virus belongs to which family?", options: ["Retroviridae", "Geminiviridae", "Flaviviridae", "Orthomyxoviridae"], answer: 1 }, // [cite: 3782, 3784]
        { q: "Which structural feature distinguishes viroids from viruses?", options: ["Presence of capsid", "Lack of nucleic acid", "Circular ssRNA without protein coat", "Double lipid membrane"], answer: 2 }, // [cite: 3785, 3787]
        { q: "HIV's destruction of helper T-cells primarily compromises:", options: ["Innate immunity", "Humoral and cell-mediated immunity", "Complement system", "Physical barriers"], answer: 1 }, // [cite: 3788, 3790]
        { q: "The 'fusion inhibitors' class of HIV drugs targets which step?", options: ["Reverse transcription", "Viral attachment", "Membrane fusion", "Protease activity"], answer: 2 }, // [cite: 3791, 3792]
        { q: "Prion propagation occurs through:", options: ["DNA replication", "Misfolded protein templating", "RNA translation", "Capsid assembly"], answer: 1 }, // [cite: 3793, 3794]
        { q: "Which viral disease demonstrates 'Koplik's spots'?", options: ["Dengue", "Measles", "Chickenpox", "Rubella"], answer: 1 }, // [cite: 3795, 3798]
        { q: "Hemorrhagic fever is characteristic of:", options: ["Polio", "Ebola", "Hepatitis A", "Rhinovirus"], answer: 1 }, // [cite: 3799, 3801]
        { q: "The CRISPR-Cas system in bacteria evolved as defense against:", options: ["Antibiotics", "Bacteriophages", "Prions", "Viroids"], answer: 1 }, // [cite: 3802, 3803]
        { q: "Which hepatitis virus has the highest chronicity rate?", options: ["HAV", "HBV", "HCV", "HDV"], answer: 2 }, // [cite: 3804, 3807]
        { q: "Antigenic shift in influenza viruses results from:", options: ["Point mutations", "Genome reassortment", "Reverse transcription", "Protease cleavage"], answer: 1 }, // [cite: 3817, 3818]
        { q: "The primary reservoir for SARS-CoV-2 is believed to be:", options: ["Pigs", "Bats", "Birds", "Mosquitoes"], answer: 1 }, // [cite: 3820, 3821]
        { q: "Which plant virus causes 'leaf rolling' symptoms?", options: ["Tobacco mosaic virus", "Potato virus Y", "Cotton leaf curl virus", "Tomato spotted wilt virus"], answer: 1 }, // [cite: 3822, 3823]
        { q: "The capsomeres in an icosahedral virus are arranged in:", options: ["Linear strands", "20 triangular faces", "Random clusters", "Concentric circles"], answer: 1 }, // [cite: 3824, 3830]
        { q: "Which component is ABSENT in viroids but present in viruses?", options: ["Genetic material", "Protein coat (capsid)", "Infectivity", "RNA genome"], answer: 1 }, // [cite: 3834, 3838]
        { q: "The genome of Hepatitis B virus is unique because it is:", options: ["ssDNA", "Partially dsDNA with an RNA intermediate stage", "Lacking a nucleocapsid", "Integrated immediately"], answer: 1 }, // [cite: 3839, 3840]
        { q: "During HIV budding, the envelope is derived from:", options: ["Viral lipid synthesis", "The host cell's plasma membrane", "Nuclear membrane", "Mitochondrial membrane"], answer: 1 }, // [cite: 3841, 3848]
        { q: "The 'eclipse phase' in viral replication refers to the period when:", options: ["Virions are visible", "No intact virions are detectable inside the host", "Host cell lyses", "Viral DNA integrates"], answer: 1 }, // [cite: 3849, 3850]
        { q: "Reverse transcriptase inhibitors act on which stage of HIV life cycle?", options: ["Integration", "DNA synthesis from an RNA template", "Protein cleavage", "Budding"], answer: 1 }, // [cite: 3851, 3852]
        { q: "Kaposi's sarcoma in AIDS patients is caused by:", options: ["HIV itself", "Opportunistic human herpesvirus-8 (HHV-8)", "Prion accumulation", "Bacterial co-infection"], answer: 1 }, // [cite: 3853, 3854]
        { q: "Which symptom is PATHOGNOMONIC for measles?", options: ["Jaundice", "Koplik's spots", "Roseola rash", "Splenomegaly"], answer: 1 }, // [cite: 3855, 3856]
        { q: "Prion diseases primarily affect which organ system?", options: ["Hepatic", "Nervous (Brain)", "Pulmonary", "Hematologic"], answer: 1 }, // [cite: 3857, 3859]
        { q: "The R0 (basic reproduction number) measures:", options: ["Mortality rate", "Transmission potential (secondary cases per infection)", "Incubation period", "Viral genome size"], answer: 1 }, // [cite: 3860, 3863]
        { q: "Which hepatitis virus is transmitted ONLY as a co-infection with HBV?", options: ["HAV", "HCV", "HDV", "HEV"], answer: 2 }, // [cite: 3864, 3865]
        { q: "Cotton Leaf Curl Virus causes economic loss primarily by:", options: ["Reducing fiber quality and yield", "Killing plants within days", "Making cotton toxic", "Preventing pollination"], answer: 0 }, // [cite: 3866, 3867]
        { q: "The 'window period' in HIV testing refers to:", options: ["Asymptomatic phase", "Time before antibodies are detectable by tests", "Final AIDS stage", "Viral dormancy"], answer: 1 }, // [cite: 3868, 3869]
        { q: "Which test confirms HIV infection by detecting specific viral proteins?", options: ["ELISA", "Western blot", "PCR", "CD4 count"], answer: 1 }, // [cite: 3870, 3871]
        { q: "Oral polio vaccine (OPV) consists of:", options: ["Killed virus", "Live attenuated (weakened) virus", "Viral DNA", "Antibodies"], answer: 1 }, // [cite: 3872, 3873]
        { q: "Which plant virus is transmitted by whiteflies?", options: ["TMV", "Begomovirus (e.g. Cotton Leaf Curl)", "Potato virus X", "Barley yellow dwarf virus"], answer: 1 }, // [cite: 3842, 3845]
        { q: "The primary reservoir for Ebola virus is:", options: ["Pigs", "Fruit bats", "Birds", "Dogs"], answer: 1 }, // [cite: 3875, 3876]
        { q: "Which virus requires HBV's surface proteins for assembly?", options: ["HAV", "HCV", "HDV", "HEV"], answer: 2 }, // [cite: 3877, 3879]
        { q: "Spillover events involve viral transmission from:", options: ["Plants to animals", "Animals to humans (zoonosis)", "Humans to plants", "Bacteria to viruses"], answer: 1 }, // [cite: 3880, 3882]
        { q: "Protease inhibitors in HIV therapy prevent:", options: ["Cell entry", "Reverse transcription", "Cleavage/Maturation of viral polyproteins", "Genome integration"], answer: 2 }, // [cite: 3883, 3884]
        { q: "The target of oseltamivir (Tamiflu) in influenza is:", options: ["Neuraminidase", "Hemagglutinin", "M2 ion channel", "RNA polymerase"], answer: 0 }, // [cite: 3885, 3887]
        { q: "A patient with fever, joint pain, and rash after a mosquito bite likely has:", options: ["Ebola", "Dengue", "Hepatitis C", "Measles"], answer: 1 }, // [cite: 3888, 3890]
        { q: "Upward leaf curling and vein thickening in cotton are caused by an agent vectored by:", options: ["Aphid", "Whitefly", "Beetle", "Nematode"], answer: 1 }, // [cite: 3891, 3893]
        { q: "Viral 'packaging signals' ensure:", options: ["Host cell entry", "Specific encapsidation of the correct viral nucleic acid", "Immune evasion", "Reverse transcription"], answer: 1 }, // [cite: 3894, 3897]
        { q: "Syncytia formation (cell fusion) is a characteristic cytopathic effect of:", options: ["Polio", "HIV", "TMV", "Hepatitis B"], answer: 1 }, // [cite: 3898, 3900]
        { q: "The 1918 influenza pandemic was notable for high mortality in which group?", options: ["Infants", "Young adults", "Elderly", "Immunocompromised"], answer: 1 }, // [cite: 3901, 3904]
        { q: "The term 'Arbovirus' refers to viruses transmitted by:", options: ["Rodents", "Arthropods (e.g. Mosquitoes/Ticks)", "Birds", "Contaminated water"], answer: 1 }, // [cite: 3905, 3908]
        { q: "Which characteristic is shared by both prions and viroids?", options: ["Cause human neurological disease", "Lack conventional nucleic acid genomes (Protein/RNA only)", "Have lipid envelopes", "Require whitefly vectors"], answer: 1 }, // [cite: 3909, 3911]
        { q: "CRISPR-Cas systems in bacteria evolved to target:", options: ["Antibiotics", "Bacteriophage DNA", "Prions", "Viroids"], answer: 1 }, // [cite: 3912, 3915]
        { q: "Antigenic drift in influenza is caused by:", options: ["Reassortment", "Point mutations in HA/NA genes", "Reverse transcription", "Protease activity"], answer: 1 }, // [cite: 3916, 3918]
        { q: "The largest known virus by genome size (up to 2.5 Mb) is:", options: ["HIV", "Pandoravirus", "Polio", "Bacteriophage T4"], answer: 1 }, // [cite: 3920, 3922]
        { q: "Plaque assays are used to quantify:", options: ["Antibody titers", "Infectious virus particles (PFU/mL)", "Genome size", "Capsid symmetry"], answer: 1 }, // [cite: 3923, 3924]
        { q: "Hemagglutination inhibition (HAI) tests are used to detect:", options: ["Viral DNA", "Antibodies that block viral surface proteins", "Reverse transcriptase", "Prion accumulation"], answer: 1 }, // [cite: 3925, 3929]
        { q: "A virus with an RNA genome is MOST likely to have a:", options: ["Low mutation rate", "High mutation rate", "Icosahedral capsid only", "Lysogenic cycle"], answer: 1 }, // [cite: 3935, 3937]
        { q: "The primary challenge in developing an HIV vaccine is:", options: ["Lack of animal models", "Rapid antigenic variation/mutation", "Small genome size", "Inability to culture the virus"], answer: 1 }, // [cite: 3938, 3939]
        { q: "The quaternary structure of capsomeres is stabilized by:", options: ["Covalent bonds", "Non-covalent bonds (H-bonds/Hydrophobic interactions)", "Ionic bonds", "Disulfide bridges"], answer: 1 }, // [cite: 3955, 3956]
        { q: "Glycoprotein spikes on enveloped viruses are essential for:", options: ["DNA replication", "Specific attachment to host receptors", "Capsid assembly", "Reverse transcription"], answer: 1 }, // [cite: 3957, 3959]
        { q: "The HIV nucleocapsid contains which components?", options: ["dsDNA and integrase", "ssRNA and reverse transcriptase", "dsRNA and protease", "ssDNA and lysozyme"], answer: 1 }, // [cite: 3960, 3961]
        { q: "Envelopes of viruses incorporate virus-specific proteins such as:", options: ["Cholesterol", "Hemagglutinin (HA)", "Phospholipids", "Transport proteins"], answer: 1 }, // [cite: 3962, 3964]
        { q: "Icosahedral symmetry is efficient because it:", options: ["Packages genome fastest", "Maximizes volume using minimal protein subunits", "Aids in entry", "Resists heat best"], answer: 1 }, // [cite: 3965, 3966]
        { q: "HIV protease is necessary for:", options: ["Attachment", "Cleaving polyproteins into functional units", "Integration", "Budding"], answer: 1 }, // [cite: 3967, 3968]
        { q: "Viral 'early genes' are typically those that encode:", options: ["Capsid proteins", "Replication and regulatory enzymes", "Envelope spikes", "Matrix proteins"], answer: 1 }, // [cite: 3969, 3972]
        { q: "The enzyme required to transcribe (-)ssRNA into mRNA is:", options: ["DNA polymerase", "RNA-dependent RNA polymerase", "Reverse transcriptase", "Integrase"], answer: 1 }, // [cite: 3972, 3973]
        { q: "Lysogenic conversion may grant bacteria:", options: ["Antibiotic resistance", "New pathogenic traits (e.g. toxins)", "Faster division", "Heat resistance"], answer: 1 }, // [cite: 3974, 3975]
        { q: "Viral uncoating describes the:", options: ["Assembly of capsids", "Release of the viral genome into the host cytoplasm", "Reverse transcription step", "Integration phase"], answer: 1 }, // [cite: 3976, 3979]
        { q: "Interferons act by inducing which of the following in nearby cells?", options: ["Direct lysis of viruses", "Synthesis of antiviral proteins (AVPs)", "Production of antibodies", "Integration of viral DNA"], answer: 1 }, // [cite: 3952, 3953]
        { q: "Kaposi's sarcoma in AIDS patients is specifically associated with:", options: ["HIV mutation", "Coinfection with HHV-8", "Prion misfolding", "Tuberculosis"], answer: 1 }, // [cite: 3985, 3987]
        { q: "The basic reproduction number (R0) depends on:", options: ["Mortality rate", "Transmission probability and contact rate", "Genome size", "Incubation period"], answer: 1 }, // [cite: 3990, 3994]
        { q: "Live attenuated vaccines consist of pathogens that:", options: ["Are killed by heat", "Are weakened but can still replicate", "Are just DNA fragments", "Are bacterial toxins"], answer: 1 }, // [cite: 3995, 3997]
        { q: "The herd immunity threshold is mathematically derived from:", options: ["Case fatality rate", "R0 and vaccine efficacy", "Viral load", "Mutation rate"], answer: 1 }, // [cite: 3998, 4000]
        { q: "Arboviruses require transmission via:", options: ["Rodents", "Arthropod vectors", "Contaminated water", "Aerosolized droplets"], answer: 1 }, // [cite: 4001, 4003]
        { q: "Pandemic potential is generally highest for viruses that exhibit:", options: ["Animal reservoirs only", "Efficient human-to-human airborne transmission", "DNA genomes", "Slow replication cycles"], answer: 1 }, // [cite: 4004, 4007]
        { q: "A 'viral load' test specifically measures the number of:", options: ["Antibodies in blood", "Viral RNA/DNA copies per mL of plasma", "CD4 cells", "Capsid subunits"], answer: 1 }, // [cite: 4008, 4011]
        { q: "Neuraminidase inhibitors like oseltamivir work by:", options: ["Preventing entry", "Blocking the release of progeny virions", "Inhibiting DNA synthesis", "Lysis of the host"], answer: 1 }, // [cite: 4012, 4014]
        { q: "The triangulation number (T) in icosahedral capsids helps calculate the:", options: ["Genome length", "Total number of capsomeres", "Envelope density", "Replication speed"], answer: 1 }, // [cite: 4047, 4049]
        { q: "A tegument layer is located between the capsid and envelope in:", options: ["Bacteriophages", "Herpesviruses", "Retroviruses", "Picornaviruses"], answer: 1 }, // [cite: 4067, 4069]
        { q: "Scaffolding proteins are essential during viral assembly for:", options: ["Packaging RNA", "Providing temporary support for capsid shell formation", "Receptor binding", "Genome excision"], answer: 1 }, // [cite: 4070, 4071]
        { q: "Rolling circle replication is the primary mechanism for:", options: ["HIV", "Bacteriophage lambda DNA synthesis", "Influenza", "Polio"], answer: 1 }, // [cite: 4075, 4077]
        { q: "Structural components like the capsid and envelope are encoded by:", options: ["Early genes", "Late genes", "Regulatory genes", "Host genes"], answer: 1 }, // [cite: 4078, 4081]
        { q: "The high mutation rate of RNA viruses leads to the formation of:", options: ["Quasispecies (diverse populations)", "Large DNA genomes", "Lysogenic cycles", "Viroids"], answer: 0 }, // [cite: 4084, 4085]
        { q: "Ribosomal frameshifting is a mechanism used by viruses to:", options: ["Evade the immune system", "Synthesize multiple distinct proteins from one mRNA", "Insert DNA into chromosomes", "Increase mutation rates"], answer: 1 }, // [cite: 4086, 4089]
        { q: "Antigenic shift specifically requires which viral characteristic?", options: ["Point mutations", "A segmented genome (allowing reassortment)", "Reverse transcription", "A lipid envelope"], answer: 1 }, // [cite: 4087, 4090]
        { q: "Endogenous retroviruses are passed between generations through:", options: ["Horizontal spread", "Vertical inheritance (germline DNA)", "Prion templating", "Insect vectors"], answer: 1 }, // [cite: 4091, 4092]
        { q: "Negri bodies are pathognomonic cytoplasmic inclusions found in:", options: ["Rabies", "Measles", "Hepatitis", "HIV"], answer: 0 }, // [cite: 4095, 4098]
        { q: "Hepatitis D (HDV) is termed a 'defective' virus because it needs:", options: ["HBV's surface proteins (HBsAg) for assembly", "A DNA genome", "Mosquito vectors", "Reverse transcriptase"], answer: 0 }, // [cite: 4099, 4100]
        { q: "In severe influenza, the 'cytokine storm' refers to:", options: ["Lysis of all immune cells", "Excessive and harmful host inflammatory response", "Prion conversion", "Antibody depletion"], answer: 1 }, // [cite: 4101, 4103]
        { q: "Viral tissue tropism is primarily restricted by the distribution of:", options: ["Capsid proteins", "Specific host cell surface receptors", "Genome size", "Lipid types"], answer: 1 }, // [cite: 4106, 4108]
        { q: "Plaque assays are used to measure the titer of:", options: ["Antibodies", "Infectious virions (PFUs)", "Genome copies", "Capsid mass"], answer: 1 }, // [cite: 4109, 4113]
        { q: "Neutralization tests evaluate the ability of antibodies to:", options: ["Integrate DNA", "Block viral infectivity/entry", "Increase mutation", "Synthesize proteins"], answer: 1 }, // [cite: 4114, 4119]
        { q: "Electron microscopy (EM) is the primary tool for identifying:", options: ["Common colds", "Novel or unculturable viruses based on morphology", "Chronic Hepatitis B", "Bacterial infections"], answer: 1 }, // [cite: 4120, 4122]
        { q: "Quantitative PCR (qPCR) is superior for:", options: ["Visualizing spikes", "Precisely quantifying the number of viral genome copies", "Folding proteins", "Measuring burst size"], answer: 1 }, // [cite: 4123, 4125]
        { q: "Viral integration into the host genome is inhibited by drugs that target:", options: ["Protease", "Integrase", "Lysozyme", "Hemagglutinin"], answer: 1 }, // [cite: 4127, 4133]
        { q: "Neuraminidase inhibitors function by:", options: ["Blocking uncoating", "Trapping progeny virions on the host cell surface", "Integrating DNA", "Lysis of virions"], answer: 1 }, // [cite: 4134, 4137]
        { q: "CRISPR-based antiviral strategies function by:", options: ["Blocking entry", "Sequence-specific cleavage of viral genomes", "Modifying ribosomes", "Dissolving envelopes"], answer: 1 }, // [cite: 4138, 4142]
        { q: "Passive immunization is characterized by the delivery of:", options: ["Attenuated viruses", "Pre-formed antibodies (e.g. convalescent plasma)", "DNA vaccines", "Toxoids"], answer: 1 }, // [cite: 4146, 4151]
        { q: "Viral metagenomics allows researchers to discover viruses by:", options: ["Culturing them", "Sequencing nucleic acids directly from environmental samples", "Looking for antibodies", "Crystallizing them"], answer: 1 }, // [cite: 4153, 4163]
        { q: "Phage therapy is used to treat bacterial infections because phages are:", options: ["Broad-spectrum", "Host-specific and lyse pathogenic bacteria", "DNA integrators", "Prion-like"], answer: 1 }, // [cite: 4164, 4165]
        { q: "Virus-like particles (VLPs) used in vaccines are essentially:", options: ["Live viruses", "Empty, non-infectious capsids that mimic viral structure", "RNA strands", "Viroids"], answer: 1 }, // [cite: 4166, 4167]
        { q: "Giant viruses (e.g. Mimivirus) encode genes for:", options: ["Reversing time", "Cellular-like metabolism and translation machinery", "Prion conversion", "Antibiotic resistance"], answer: 1 }, // [cite: 4171, 4176]
        { q: "An 'abortive' infection is one in which:", options: ["Latency occurs", "No progeny virions are produced", "Chronic disease results", "Mutations occur"], answer: 1 }, // [cite: 4173, 4180]
        { q: "Pseudotyped viruses are specifically engineered to study:", options: ["Capsid symmetry", "Viral entry mechanisms using different envelopes", "DNA integration", "Budding rates"], answer: 1 }, // [cite: 4181]
        { q: "Non-lytic viral release (budding) is typical for:", options: ["T4 phages", "Enveloped viruses (e.g. HIV)", "Viroids", "Prions"], answer: 1 } // [cite: 4182, 4184]
    ]
},
        { id: 'T2', title: 'Biology Chapter 1: Cell Structure', subject: 'Biology', chapter: '1', exam: 'MDCAT', province: 'Punjab', 
          mcqs: [{ q: "Basic unit of life?", options: ["Cell", "Tissue", "Organ", "Molecule"], answer: 0 }, { q: "Protein synthesis organelle?", options: ["Nucleus", "Mitochondria", "Ribosome", "Golgi"], answer: 2 }] 
        }
    ];

    let activeTestMCQs = [];
    let userSelections = [];
    let currentOpenTest = null;
    let timerInterval = null;
    let totalSeconds = 0;
    let selectedPct = 1.0;
    let pendingTestId = null;

    const provinceSelect = document.getElementById('filter-province');
    const examSelect = document.getElementById('filter-exam');
    const subjectSelect = document.getElementById('filter-subject');
    const chapterSelect = document.getElementById('filter-chapter');

    function initializeFilters() { updateExams(); }

    function updateExams() {
        examSelect.innerHTML = '<option value="all">All Exams</option>';
        mdcatExams.forEach(exam => {
            const option = document.createElement('option');
            option.value = exam; option.textContent = exam; examSelect.appendChild(option);
        });
        updateSubjects();
    }

    function updateSubjects() {
        const exam = examSelect.value;
        subjectSelect.innerHTML = '<option value="all">All Subjects</option>';
        if (exam !== 'all') {
            subjectSelect.disabled = false;
            (examSubjects[exam] || []).forEach(subject => {
                if (subject !== "All Subjects") {
                    const option = document.createElement('option');
                    option.value = subject; option.textContent = subject; subjectSelect.appendChild(option);
                }
            });
        } else {
            subjectSelect.disabled = true; chapterSelect.disabled = true;
        }
        updateChapters();
    }

    function updateChapters() {
        const exam = examSelect.value;
        const subject = subjectSelect.value;
        chapterSelect.innerHTML = '<option value="all">All Chapters</option>';
        if (subject !== 'all' && exam !== 'all') {
            chapterSelect.disabled = false;
            const key = `${exam}_${subject.replace(/\s+/g, '_')}`;
            (examSubjectChapters[key] || []).forEach(chapter => {
                const option = document.createElement('option');
                option.value = chapter; option.textContent = chapter; chapterSelect.appendChild(option);
            });
        } else {
            chapterSelect.disabled = true;
        }
        loadTests();
    }

    function loadTests() {
        const container = document.getElementById('tests-container');
        const provVal = provinceSelect.value;
        const examVal = examSelect.value;
        const subVal = subjectSelect.value;
        const chapVal = chapterSelect.value;

        const filtered = testsData.filter(t => 
            (provVal === 'all' || t.province === provVal) &&
            (examVal === 'all' || t.exam === examVal) &&
            (subVal === 'all' || t.subject === subVal) &&
            (chapVal === 'all' || t.chapter === chapVal)
        );

        if (filtered.length === 0) {
            container.innerHTML = '';
            document.getElementById('no-content-message').classList.remove('hidden');
        } else {
            document.getElementById('no-content-message').classList.add('hidden');
            container.innerHTML = filtered.map(test => `
                <div class="card test-card">
                    <div>
                        <h4>${test.title}</h4>
                        <p style="font-size:0.85rem; color:var(--color-primary-blue); font-weight:600;">${test.subject} | ${test.chapter}</p>
                    </div>
                    <button class="button primary-button" onclick="openConfigModal('${test.id}')">
                        <i class="fas fa-play"></i> Start Test
                    </button>
                </div>
            `).join('');
        }
    }

    /* Addition: Registration Flow */
    function openConfigModal(id) {
        pendingTestId = id;
        document.getElementById('configModal').style.display = 'block';
        document.body.style.overflow = 'hidden';
    }

    function setPercentage(val, btn) {
        selectedPct = val;
        document.querySelectorAll('.pct-btn').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
    }

    function handleDetailsSubmit(e) {
        e.preventDefault();
        const stdDetails = {
            name: document.getElementById('user-name').value,
            city: document.getElementById('user-city').value,
            whatsapp: document.getElementById('user-whatsapp').value,
            testId: pendingTestId,
            mode: selectedPct * 100 + "%"
        };
        
        // Replace with your Google Apps Script URL
        const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbx5PYcNHuM3vJIqRSK2SpqeK986JgD30a0oUbc9KopT8rlv_8rJCQRtp8K4xwKWBCZogA/exec";
        fetch(SCRIPT_URL, { method: 'POST', mode: 'no-cors', body: JSON.stringify(stdDetails) });

        document.getElementById('configModal').style.display = 'none';
        openActualTest(pendingTestId);
    }

    function openActualTest(id) {
        const test = testsData.find(t => t.id === id);
        if(!test) return;

        // SLICING LOGIC
        const qty = Math.floor(test.mcqs.length * selectedPct);
        activeTestMCQs = [...test.mcqs].sort(() => 0.5 - Math.random()).slice(0, qty);
        
        currentOpenTest = test;
        userSelections = [];
        document.getElementById('test-modal-title').innerText = `${test.title} (${selectedPct*100}%)`;
        
        document.getElementById('mcq-questions').innerHTML = activeTestMCQs.map((m, i) => `
            <div class="mcq-question" id="q-block-${i}">
                <p style="font-weight: 600; margin-bottom: 10px;">Q${i+1}: ${m.q}</p>
                <div class="options-list">
                    ${m.options.map((opt, oi) => `
                        <div class="mcq-option">
                            <label id="label-${i}-${oi}">
                                <input type="radio" name="q${i}" value="${oi}" required>
                                <span>${opt}</span>
                            </label>
                        </div>
                    `).join('')}
                </div>
            </div>
        `).join('');

        document.getElementById('mcq-form').classList.remove('hidden');
        document.getElementById('result-summary').classList.add('hidden');
        document.getElementById('submit-btn').classList.remove('hidden');
        document.getElementById('review-actions').classList.add('hidden');
        document.getElementById('timer-container').classList.remove('hidden');
        document.getElementById('testModal').style.display = 'block';
        startTimer(activeTestMCQs.length * 40);
    }

    function startTimer(duration) {
        clearInterval(timerInterval);
        totalSeconds = duration;
        updateTimerDisplay();
        timerInterval = setInterval(() => {
            if (--totalSeconds < 0) { clearInterval(timerInterval); submitTest(); }
            else updateTimerDisplay();
        }, 1000);
    }

    function updateTimerDisplay() {
        const m = Math.floor(totalSeconds / 60), s = totalSeconds % 60;
        document.getElementById('time-left').textContent = `${m.toString().padStart(2,'0')}:${s.toString().padStart(2,'0')}`;
    }

    function submitTest(e) {
        if(e) e.preventDefault();
        clearInterval(timerInterval);
        document.getElementById('timer-container').classList.add('hidden');
        let correct = 0;
        userSelections = [];
        activeTestMCQs.forEach((m, i) => {
            const radios = document.getElementsByName(`q${i}`);
            let val = -1;
            radios.forEach(r => { if(r.checked) val = parseInt(r.value); });
            userSelections.push(val);
            if(val === m.answer) correct++;
        });

        document.getElementById('result-total').innerText = activeTestMCQs.length;
        document.getElementById('result-correct').innerText = correct;
        document.getElementById('result-percentage').innerText = ((correct/activeTestMCQs.length)*100).toFixed(0) + "%";
        document.getElementById('mcq-form').classList.add('hidden');
        document.getElementById('result-summary').classList.remove('hidden');
    }

    function checkTest() {
        document.getElementById('mcq-form').classList.remove('hidden');
        document.getElementById('result-summary').classList.add('hidden');
        document.getElementById('submit-btn').classList.add('hidden');
        document.getElementById('review-actions').classList.remove('hidden');
        activeTestMCQs.forEach((m, i) => {
            const sel = userSelections[i], cor = m.answer;
            const radios = document.getElementsByName(`q${i}`);
            radios.forEach(r => r.disabled = true);
            if(document.getElementById(`label-${i}-${cor}`)) document.getElementById(`label-${i}-${cor}`).classList.add('correct-ans');
            if(sel !== -1 && sel !== cor && document.getElementById(`label-${i}-${sel}`)) document.getElementById(`label-${i}-${sel}`).classList.add('wrong-ans');
        });
    }

    function backToResults() {
        document.getElementById('mcq-form').classList.add('hidden');
        document.getElementById('result-summary').classList.remove('hidden');
        document.getElementById('review-actions').classList.add('hidden');
    }

    function downloadTestPDF() {
        const { jsPDF } = window.jspdf;
        const doc = new jsPDF();
        doc.text(currentOpenTest.title, 14, 20);
        doc.save(`${currentOpenTest.title}.pdf`);
    }

    function closeModal(id) {
        document.getElementById(id).style.display = 'none';
        document.body.style.overflow = 'auto';
        clearInterval(timerInterval);
    }

    function mobileMenuToggle() { document.getElementById('navLinks').classList.toggle('active'); }

    window.onclick = (e) => { if(e.target.className === 'modal') closeModal(e.target.id); };
    document.addEventListener('DOMContentLoaded', initializeFilters);
</script>
</body>
</html>
