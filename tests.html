<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Practice Tests - Dani Medico</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.25/jspdf.plugin.autotable.min.js"></script>
    <style>
        /* Enhanced CSS with Gradients and Animations */
        :root {
            --color-primary-blue: #007BFF;
            --color-primary-blue-light: #4da6ff;
            --color-primary-blue-dark: #0056b3;
            --color-secondary-green: #28A745;
            --color-secondary-green-light: #34ce57;
            --color-secondary-green-dark: #1e7e34;
            --color-light: #F8F9FA;
            --color-dark: #343A40;
            --color-text: #495057;
            --color-card-bg: #FFFFFF;
            --color-shadow: rgba(0, 0, 0, 0.1);
            --color-danger: #DC3545;
            --color-danger-light: #e4606d;
            --color-warning: #FFC107;
            --color-warning-light: #ffce3a;
            --font-family-primary: 'Poppins', sans-serif;
            --border-radius-base: 12px;
            --transition-speed: 0.4s;
            --animation-duration: 0.5s;
        }

        /* --- 2. ANTI-OVERFLOW & GLOBAL RESET --- */
        html, body { 
            width: 100%; 
            margin: 0; 
            padding: 0; 
            overflow-x: hidden; 
            position: relative; 
            box-sizing: border-box; 
            font-family: var(--font-family-primary); 
            line-height: 1.6;
            color: var(--color-text); 
            background: linear-gradient(135deg, #f5f7fa 0%, #e4edf5 100%);
            min-height: 100vh;
            display: flex; 
            flex-direction: column;
            padding-top: 55px;
        }
        *, *:before, *:after { box-sizing: inherit; }
        * { margin: 0; padding: 0; }

        .container { 
            width: 100%; 
            max-width: 1400px; 
            margin: 0 auto; 
            padding: 15px 20px; 
            flex-grow: 1; 
        }
        section { 
            padding: 2rem 0; 
        }
        a { 
            text-decoration: none; 
            color: var(--color-primary-blue); 
            transition: all var(--transition-speed); 
        }
        a:hover { 
            color: var(--color-secondary-green); 
        }
        h1, h2, h3, h4 { 
            color: var(--color-dark); 
            margin-bottom: 1rem; 
            position: relative;
        }
        
        h2 { 
            display: inline-block; 
            padding-bottom: 0.5rem; 
            position: relative; 
            margin-bottom: 1.5rem;
            color: var(--color-dark);
        }
        
        h2::after {
            content: ''; 
            position: absolute; 
            left: 0; 
            bottom: 0; 
            width: 60px; 
            height: 4px;
            background: linear-gradient(90deg, var(--color-primary-blue), var(--color-secondary-green));
            border-radius: 2px;
        }
        /* --- NAVBAR MATCHING HOMEPAGE WITH STICKY HEADER --- */
        #navbar { 
            background: linear-gradient(135deg, var(--color-primary-blue) 0%, var(--color-primary-blue-dark) 100%);
            color: var(--color-light); 
            padding: 0.75rem 1.5rem; /* Reduced padding */
            display: flex; 
            justify-content: space-between; 
            align-items: center; 
            box-shadow: 0 4px 12px rgba(0, 123, 255, 0.2);
            z-index: 1000; 
            position: fixed; 
            top: 0; 
            left: 0;
            right: 0;
            width: 100%;
        }
        
        .logo { 
            font-size: 1.4rem; /* Slightly smaller */
            font-weight: 700; 
            color: var(--color-light); 
            display: flex; 
            align-items: center; 
            gap: 0.75rem; 
            transition: transform var(--transition-speed);
        }
        
        .logo:hover {
            transform: translateY(-2px);
        }
        
        .logo-img { 
            height: 70px; /* Reduced from 60px */
            width: auto; 
            filter: drop-shadow(0 2px 4px rgba(0,0,0,0.2));
        }
        
        .nav-links { 
            display: flex;
            align-items: center;
        }
        
        .nav-links a { 
            color: var(--color-light); 
            margin-left: 0.75rem; /* Reduced from 1.5rem */
            padding: 0.5rem 0.75rem; /* Reduced padding */
            font-weight: 500; 
            transition: all var(--transition-speed); 
            border-radius: 8px; /* Slightly smaller */
            position: relative;
            overflow: hidden;
            font-size: 0.9rem; /* Smaller font */
            display: flex;
            align-items: center;
            gap: 0.4rem; /* Reduced gap */
            white-space: nowrap;
        }
        
        .nav-links a i {
            font-size: 0.9rem; /* Smaller icons */
        }
        
        .nav-links a::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: left 0.7s ease;
        }
        
        .nav-links a:hover::before {
            left: 100%;
        }
        
        .nav-links a:hover, .nav-links a.active { 
            background: rgba(255, 255, 255, 0.1);
            transform: translateY(-2px);
            box-shadow: 0 3px 6px rgba(0,0,0,0.1); /* Smaller shadow */
        }
        
        .mobile-menu-btn { 
            display: none; 
            background: none; 
            border: none; 
            color: var(--color-light); 
            font-size: 1.25rem; /* Smaller button */
            cursor: pointer; 
            transition: transform var(--transition-speed);
            padding: 0.4rem;
        }
        
        .mobile-menu-btn:hover {
            transform: scale(1.1);
        }

        /* Add padding to main to account for fixed navbar */
        main {
            margin-top: 70px; 
        }

        /* --- ENHANCED GRID SYSTEM - 5 PC / 2 MOBILE --- */
        .card-grid { 
            display: grid; 
            gap: 20px; 
            margin-top: 1.5rem; 
            width: 100%; 
        }
        @media (min-width: 1024px) { 
            .card-grid { 
                grid-template-columns: repeat(5, 1fr); 
            } 
        }
        @media (max-width: 1023px) { 
            .card-grid { 
                grid-template-columns: repeat(2, 1fr); 
            } 
        }
        @media (max-width: 480px) { 
            .card-grid { 
                grid-template-columns: 1fr; 
            } 
        }

        /* --- ENHANCED TEST CARD DESIGN --- */
        .card { 
            background: linear-gradient(145deg, var(--color-card-bg) 0%, #f8f9fa 100%);
            padding: 1.5rem; 
            border-radius: var(--border-radius-base); 
            box-shadow: 0 6px 20px var(--color-shadow); 
            height: 100%; 
            display: flex; 
            flex-direction: column; 
            justify-content: space-between; 
            border-left: 5px solid var(--color-secondary-green);
            transition: all var(--transition-speed);
            position: relative;
            overflow: hidden;
        }
        
        .card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: linear-gradient(90deg, var(--color-primary-blue), var(--color-secondary-green));
            transform: translateX(-100%);
            transition: transform var(--transition-speed);
        }
        
        .card:hover::before {
            transform: translateX(0);
        }
        
        .card:hover { 
            transform: translateY(-8px) scale(1.02); 
            box-shadow: 0 12px 30px rgba(0, 123, 255, 0.15); 
        }
        
        .test-card { 
            border-left: 5px solid var(--color-secondary-green); 
        }
        .test-card h4 { 
            color: var(--color-primary-blue); 
            font-size: 1rem; 
            height: 3.2rem; 
            overflow: hidden; 
            margin-bottom: 8px; 
            line-height: 1.4; 
            font-weight: 600;
        }
        
        /* New Metadata styling */
        .card-meta { display: flex; flex-wrap: wrap; gap: 10px; font-size: 0.75rem; color: #666; margin-bottom: 12px; font-weight: 500; }
        .card-meta span { display: flex; align-items: center; gap: 4px; }

        /* --- ENHANCED DEPENDENT FILTERS --- */
        .filters-section { 
            background: linear-gradient(145deg, var(--color-card-bg) 0%, #f8f9fa 100%);
            padding: 1.5rem; 
            border-radius: var(--border-radius-base); 
            box-shadow: 0 6px 20px var(--color-shadow); 
            display: grid; 
            grid-template-columns: repeat(4, 1fr);
            gap: 20px; 
            margin-bottom: 2rem; 
            border-left: 4px solid var(--color-primary-blue);
            position: relative;
            overflow: hidden;
        }
        
        .filters-section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: linear-gradient(90deg, var(--color-primary-blue), var(--color-secondary-green));
            transform: translateX(-100%);
            transition: transform var(--transition-speed);
        }
        
        .filters-section:hover::before {
            transform: translateX(0);
        }
        
        .filter-group { 
            flex: 1; 
            min-width: 0; 
        }
        .filter-group label { 
            font-weight: 600; 
            display: block; 
            margin-bottom: 8px; 
            font-size: 0.95rem; 
            color: var(--color-dark);
            display: flex;
            align-items: center;
          0 gap: 0.5rem;
        }
        .filter-group select, .filter-group input { 
            width: 100%; 
            padding: 0.85rem; 
            border: 2px solid #e0e0e0; 
            border-radius: 8px; 
  0         font-size: 0.95rem; 
            cursor: pointer; 
            font-family: inherit; 
            transition: all var(--transition-speed);
            background: var(--color-card-bg);
        }

        /* --- ENHANCED BUTTONS --- */
        .button { 
            display: block; 
            padding: 0.75rem 1rem; 
            border-radius: 8px; 
            font-weight: 600; 
            cursor: pointer; 
            text-align: center; 
            border: 2px solid transparent; 
            font-size: 0.85rem; 
            width: 100%; 
            margin-top: 8px; 
            text-decoration: none; 
            transition: all var(--transition-speed);
          0 position: relative;
            overflow: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
        }
        
        .button::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.3);
            transform: translate(-50%, -50%);
  0         transition: width 0.6s, height 0.6s;
        }
        
        .button:hover::before {
            width: 200px;
            height: 200px;
        }
        
        .primary-button { 
            background: linear-gradient(135deg, var(--color-secondary-green) 0%, var(--color-secondary-green-dark) 100%);
            color: white; 
            box-shadow: 0 4px 12px rgba(40, 167, 69, 0.3);
        }
        
        .primary-button:hover { 
            transform: translateY(-3px);
            box-shadow: 0 6px 18px rgba(40, 167, 69, 0.4);
            background: linear-gradient(135deg, var(--color-secondary-green-light) 0%, var(--color-secondary-green) 100%);
        }
        
  0     .secondary-button { 
            background: linear-gradient(135deg, var(--color-light) 0%, #e9ecef 100%);
            color: var(--color-primary-blue); 
            border-color: var(--color-primary-blue);
            box-shadow: 0 4px 12px rgba(0, 123, 255, 0.15);
        }
        
        .secondary-button:hover { 
            background: linear-gradient(135deg, var(--color-primary-blue) 0%, var(--color-primary-blue-dark) 100%);
            color: var(--color-light); 
            transform: translateY(-3px);
            box-shadow: 0 6px 18px rgba(0, 123, 255, 0.25);
        }

        #timer-display {
            font-weight: bold;
            color: white;
            background: linear-gradient(135deg, var(--color-danger) 0%, var(--color-danger-light) 100%);
            padding: 10px 20px;
            border-radius: 30px;
            border: 2px solid white;
            box-shadow: 0 4px 15px rgba(220, 53, 69, 0.3);
            display: inline-flex;
            align-items: center;
            gap: 0.75rem;
            margin-bottom: 15px;
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        
        /* Sequential MCQ styles */
        .mcq-step { display: none; }
        .mcq-step.active { display: block; animation: fadeIn 0.4s ease; }
        .quiz-footer { display: flex; justify-content: space-between; margin-top: 2rem; padding-top: 1rem; border-top: 1px solid #eee; }

        /* --- ENHANCED FULL SCREEN MODAL --- */
        .modal { 
            display: none; 
            position: fixed; 
            z-index: 2000; 
            left: 0; 
            top: 0; 
            width: 100%; 
            height: 100%; 
  0         background: linear-gradient(135deg, rgba(0, 0, 0, 0.95), rgba(0, 0, 0, 0.85));
            backdrop-filter: blur(10px); 
            overflow-y: auto; 
            animation: fadeIn 0.3s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        .modal-content { 
            background: linear-gradient(145deg, var(--color-card-bg) 0%, #f8f9fa 100%);
  0         margin: 20px auto; 
            padding: 30px; 
            border-radius: 16px; 
            width: 98%; 
            max-width: 1200px; 
            position: relative; 
            min-height: 95vh;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.1);
            animation: slideUp 0.4s ease;
        }
        
        @keyframes slideUp {
            from { transform: translateY(50px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        
        .close-btn { 
            position: absolute; 
            top: 15px; 
            right: 25px; 
            color: var(--color-dark); 
            font-size: 35px; 
            font-weight: bold; 
            cursor: pointer; 
  0         z-index: 10; 
            line-height: 1; 
            transition: color var(--transition-speed);
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
  0         justify-content: center;
            border-radius: 50%;
        }
        
        .close-btn:hover { 
            color: var(--color-danger);
  0         background: rgba(0, 0, 0, 0.05);
        }
        
        .mcq-question { 
            padding: 1.75rem; 
            border: 1px solid #e9ecef; 
  0         border-radius: 12px; 
            margin-bottom: 1.5rem; 
            background: linear-gradient(145deg, #ffffff, #f8f9fa);
            transition: all var(--transition-speed);
            border-left: 4px solid var(--color-primary-blue);
  0     }
        
        .mcq-question:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }
        
        .mcq-option { 
            margin: 12px 0; 
        }
        .mcq-option label { 
            display: block; 
            padding: 14px; 
          0 border: 2px solid #e9ecef; 
            border-radius: 8px; 
            cursor: pointer; 
            font-size: 0.95rem; 
            transition: all 0.3s;
            background: white;
  0     }
        
        .mcq-option label:hover { 
            background: linear-gradient(135deg, rgba(0, 123, 255, 0.05), rgba(40, 167, 69, 0.05));
            border-color: var(--color-primary-blue); 
            transform: translateX(5px);
  0     }
        
        .mcq-option input[type="radio"]:checked + span {
            font-weight: 600;
            color: var(--color-primary-blue);
        }

        .correct-ans { 
            background: linear-gradient(135deg, #d4edda, #c3e6cb) !important; 
            border-color: #28a745 !important; 
  0         color: #155724;
            animation: correctPulse 1.5s ease;
        }
        
        @keyframes correctPulse {
            0%, 100% { transform: scale(1); }
  0         50% { transform: scale(1.02); }
        }
        
        .wrong-ans { 
            background: linear-gradient(135deg, #f8d7da, #f5c6cb) !important; 
            border-color: #dc3545 !important; 
          0 color: #721c24;
            animation: shake 0.5s ease;
        }
        
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
  0         25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }

        #result-summary {
            background: linear-gradient(135deg, #ffffff, #f8f9fa);
  0         border-radius: 16px;
            padding: 3rem;
            border-left: 4px solid var(--color-secondary-green);
            animation: fadeIn 0.5s ease;
        }
        
  0     #result-summary .fa-award {
            animation: float 3s ease-in-out infinite;
            background: linear-gradient(135deg, var(--color-primary-blue), var(--color-secondary-green));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
  0     }
        
        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-15px); }
        }

        /* --- NEW PERCENTAGE SELECTOR DESIGN --- */
        .pct-selector {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
          0 gap: 10px;
            margin: 20px 0;
        }
        .pct-btn {
            border: 2px solid var(--color-primary-blue);
            background: white;
            color: var(--color-primary-blue);
  0         padding: 12px;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: 0.3s;
  0     }
        .pct-btn.active {
            background: var(--color-primary-blue);
            color: white;
            box-shadow: 0 4px 10px rgba(0,123,255,0.3);
        }

  0     footer { 
            background: linear-gradient(135deg, var(--color-primary-blue-dark) 0%, var(--color-primary-blue) 100%);
            color: var(--color-light); 
            padding: 2rem 1rem 0; 
            margin-top: 3rem; 
  0         position: relative;
        }
        
        footer::before {
            content: '';
            position: absolute;
  0         top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, var(--color-secondary-green), var(--color-primary-blue-light));
  0     }
        
        .footer-top { 
            display: flex; 
            justify-content: space-between; 
            align-items: center; 
  0         padding-bottom: 1.5rem; 
            border-bottom: 1px solid rgba(255, 255, 255, 0.1); 
            gap: 1rem; 
        }
        
        .footer-logo .logo-img { 
  0         height: 80px; 
            filter: drop-shadow(0 2px 4px rgba(0,0,0,0.2));
        }
        
        .footer-links { 
            display: flex; 
  0         gap: 1.5rem; 
        }
        
        .footer-links a { 
            color: var(--color-light); 
  0         font-weight: 500; 
            transition: all var(--transition-speed); 
            padding: 0.5rem;
            border-radius: 4px;
        }
  0     
        .footer-links a:hover { 
            color: var(--color-secondary-green); 
            background: rgba(255, 255, 255, 0.1);
  0         transform: translateY(-2px);
        }
        
        .social-icons a { 
            color: var(--color-light); 
  0         font-size: 1.5rem; 
            margin-left: 1rem; 
            transition: all var(--transition-speed);
            display: inline-flex;
  0         align-items: center;
            justify-content: center;
            width: 40px;
            height: 40px;
  0         border-radius: 50%;
            background: rgba(255, 255, 255, 0.1);
        }
        
        .social-icons a:hover { 
  0         color: var(--color-secondary-green); 
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-3px) scale(1.1);
        }
  0     
        .footer-bottom { 
            text-align: center; 
  0         padding: 1.5rem 0; 
            opacity: 0.8;
        }

        /* Section Icons */
  0     .section-icon {
            display: inline-block;
            margin-right: 0.75rem;
            font-size: 1.5rem;
  0         background: linear-gradient(135deg, var(--color-primary-blue), var(--color-secondary-green));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
  0     }
        /* Responsive Design */
        @media (max-width: 992px) {
            .nav-links a {
          0     font-size: 0.85rem; /* Even smaller on medium screens */
                padding: 0.4rem 0.6rem;
                margin-left: 0.5rem;
  0             gap: 0.3rem;
            }
            
            .nav-links a i {
                font-size: 0.85rem;
  0         }
            
            .logo {
                font-size: 1.3rem;
  0         }
            
            .logo-img {
                height: 45px;
  0         }
        }
        
        @media (max-width: 768px) {
            #navbar {
  0             padding: 0.6rem 1rem; /* Reduced mobile padding */
            }
            
            .nav-links { 
  0             display: none; 
                flex-direction: column; 
                width: 100%; 
                position: absolute; 
  0             top: 60px; /* Adjusted for smaller navbar */
                left: 0; 
                background: linear-gradient(135deg, var(--color-primary-blue-dark) 0%, var(--color-primary-blue) 100%);
  0             box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2); 
                padding: 0.75rem 0; /* Reduced padding */
                border-radius: 0 0 var(--border-radius-base) var(--border-radius-base);
  0         }
            
            .nav-links.active { 
                display: flex; 
  0         }
            
            .nav-links a { 
                margin: 0.3rem 0.75rem; /* Reduced margin */
  0             padding: 0.75rem; /* Reduced padding */
                text-align: center; 
                width: calc(100% - 1.5rem); 
                border-bottom: none; 
  0             border-radius: var(--border-radius-base); 
                font-size: 0.9rem;
  0             justify-content: center;
                gap: 0.5rem;
            }
  0         
            .nav-links a i {
                font-size: 0.95rem;
  0         }
            
            .mobile-menu-btn { 
  0             display: block; 
                padding: 0.3rem; /* Smaller padding */
  0             font-size: 1.1rem; /* Smaller icon */
  0         }
            
  0         .mobile-menu-btn:hover {
                transform: scale(1.05);
  0         }
  0         
  0         .footer-top { 
  0             flex-direction: column; 
  0             text-align: center; 
  0         }
  0         
  0         .footer-links { 
  0             flex-direction: column; 
  0             gap: 0.75rem; 
  0             margin: 1rem 0;
  0         }
  0         
  0         .social-icons { 
  0             margin-top: 1rem; 
  0         }
  0         
  0         .hero-section h1 {
  0             font-size: 2rem;
  0         }
  0         
  0         .exam-grid, .province-grid {
  0             grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
  0         }
  0     }
  0     
  0     @media (max-width: 480px) {
  0         #navbar {
  0             padding: 0.5rem 0.75rem;
  0         }
  0         
  0         .logo {
  0             font-size: 1.2rem;
  0             gap: 0.5rem;
  0         }
  0         
  0         .logo-img {
  0             height: 40px;
  0         }
  0         
  0         .hero-section {
  0             padding: 3rem 1rem;
  0         }
  0         
  0         .hero-section h1 {
  0             font-size: 1.75rem;
  0         }
  0         
  0         .card {
  0             padding: 1.25rem;
  0         }
  0         
  0         .mobile-menu-btn {
  0             font-size: 1rem;
  0         }
  0     }

  0     /* Floating Animation */
  0     @keyframes float {
  0         0%, 100% { transform: translateY(0); }
  0         50% { transform: translateY(-10px); }
  0     }
  0     
  0     .float-animation {
  0         animation: float 3s ease-in-out infinite;
  0     }
  0 </style>
</head>
<body>
  0 
<header>
  0 <nav id="navbar">
  0     <div class="logo">
  0         <img src="assets/images/logo.png" alt="Dani Medico Logo" class="logo-img">
  0         Dani Medico
  0     </div>
  0     <div class="nav-links" id="navLinks">
  0         <a href="/"><i class="fas fa-home"></i> Home</a>
  0         <a href="/dashboard"><i class="fas fa-tachometer-alt"></i> Dashboard</a>
  0         <a href="/lectures"><i class="fas fa-video"></i> Books</a>
  0         <a href="/notes"><i class="fas fa-book-open"></i> Notes</a>
  0         <a href="/tests" class="active"><i class="fas fa-pencil-alt"></i> Tests</a>
  0         <a href="/past-papers"><i class="fas fa-file-alt"></i> Papers</a>
  0         <a href="/announcement"><i class="fas fa-bullhorn"></i> News</a>
  0     </div>
  0     <button class="mobile-menu-btn" onclick="mobileMenuToggle()">
  0         <i class="fas fa-bars"></i>
  0     </button>
  0 </nav>
</header>

<main class="container">
  0 <h2><i class="fas fa-pencil-alt"></i> Practice Tests</h2>
  0 <section class="filters-section card">
  0     <div class="filter-group">
  0         <label><i class="fas fa-map-marker-alt"></i> Province:</label>
  0         <select id="filter-province" onchange="updateExams()">
  0             <option value="all">All Provinces</option>
  0             <option value="Sindh">Sindh</option>
  0             <option value="Punjab">Punjab</option>
  0             <option value="KPK">KPK</option>
  0             <option value="Balochistan">Balochistan</option>
  0             <option value="Islamabad">Islamabad</option>
  0         </select>
  0     </div>
  0     <div class="filter-group">
  0         <label><i class="fas fa-clipboard-list"></i> Exam:</label>
  0         <select id="filter-exam" onchange="updateSubjects()">
  0             <option value="all">All Exams</option>
  0         </select>
  0     </div>
  0     <div class="filter-group">
  0         <label><i class="fas fa-book"></i> Subject:</label>
  0         <select id="filter-subject" onchange="updateChapters()">
  0             <option value="all">All Subjects</option>
  0         </select>
  0     </div>
  0     <div class="filter-group">
  0         <label><i class="fas fa-layer-group"></i> Chapter:</label>
  0         <select id="filter-chapter" onchange="loadTests()">
  0             <option value="all">All Chapters</option>
  0         </select>
  0     </div>
  0 </section>

  0 <div id="tests-container" class="card-grid"></div>
  0 <p id="no-content-message" class="hidden text-center"></p>
</main>

<div id="configModal" class="modal">
  0 <div class="modal-content" style="max-width: 500px; min-height: auto;">
  0     <span class="close-btn" onclick="closeModal('configModal')">&times;</span>
  0     <h3 class="text-center" style="color: var(--color-primary-blue);"><i class="fas fa-user-edit"></i> Student Registration</h3>
  0     <p class="text-center" style="font-size: 0.9rem; margin-bottom: 20px;">Enter your details to proceed with the test.</p>
  0     
  0     <form id="details-form" onsubmit="handleDetailsSubmit(event)">
  0         <div class="filter-group" style="margin-bottom: 15px;">
  0             <label><i class="fas fa-user"></i> Name:</label>
  0             <input type="text" id="user-name" required placeholder="Full Name">
  0         </div>
  0         <div class="filter-group" style="margin-bottom: 15px;">
  0             <label><i class="fas fa-city"></i> City:</label>
  0             <input type="text" id="user-city" required placeholder="City Name">
  0         </div>
  0         <div class="filter-group" style="margin-bottom: 15px;">
  0             <label><i class="fab fa-whatsapp"></i> WhatsApp No:</label>
  0             <input type="tel" id="user-whatsapp" required placeholder="03001234567">
  0         </div>
  0         
  0         <label style="font-weight:600; display: block; margin-top: 15px;">Select Test Length:</label>
  0         <div class="pct-selector">
  0             <button type="button" class="pct-btn" onclick="setPercentage(0.25, this)">25%</button>
  0             <button type="button" class="pct-btn" onclick="setPercentage(0.50, this)">50%</button>
  0             <button type="button" class="pct-btn" onclick="setPercentage(0.75, this)">75%</button>
  0             <button type="button" class="pct-btn active" id="default-pct" onclick="setPercentage(1.0, this)">Full</button>
  0         </div>

  0         <button type="submit" class="button primary-button" style="height: 50px; font-size: 1.1rem; margin-top: 20px;">
  0             Start Test <i class="fas fa-chevron-right"></i>
  0         </button>
  0     </form>
  0 </div>
</div>

<div id="testModal" class="modal">
  0 <div class="modal-content">
  0     <span class="close-btn" onclick="closeModal('testModal')">&times;</span>
  0     <h3 id="test-modal-title">Interactive Quiz</h3>
  0     
  0     <div id="timer-container" class="text-center">
  0         <div id="timer-display"><i class="fas fa-clock"></i> Time Left: <span id="time-left">00:00</span></div>
  0     </div>

  0     <hr style="margin: 15px 0; opacity: 0.1;">
  0     
  0     <form id="mcq-form" onsubmit="submitTest(event)">
  0         <div id="mcq-steps-container"></div>
  0     </form>

  0     <div id="review-actions" class="hidden" style="margin-bottom: 20px;">
  0         <button class="button secondary-button" onclick="backToResults()" style="max-width: 200px;">
  0             <i class="fas fa-arrow-left"></i> Back to Results
  0         </button>
  0     </div>

  0     <div id="result-summary" class="hidden" style="text-align: center; padding: 2rem;">
  0         <i class="fas fa-award floating-icon" style="font-size: 4rem;"></i>
  0         <h2 style="margin-top: 1rem;">Test Completed!</h2>
  0         <p style="font-size: 1.2rem; margin: 10px 0;">Score: <strong id="result-percentage" style="color: var(--color-primary-blue);"></strong></p>
  0         <p>Correct Answers: <span id="result-correct"></span> / <span id="result-total"></span></p>
  0         
  0         <div style="display: flex; gap: 10px; flex-wrap: wrap; margin-top: 20px; justify-content: center;">
  0             <button class="button secondary-button" onclick="checkTest()">
  0                 <i class="fas fa-search"></i> Check Test
  0             </button>
  0             <button class="button primary-button" onclick="downloadTestPDF()" style="background: linear-gradient(135deg, var(--color-danger) 0%, var(--color-danger-light) 100%); border: none;">
  0                 <i class="fas fa-file-pdf"></i> Download Paper
  0             </button>
  0         </div>
  0         <button class="button primary-button" onclick="closeModal('testModal')" style="max-width: 250px; margin: 20px auto;">Close and Continue</button>
  0     </div>
  0 </div>
</div>

<footer>
  0 <div class="footer-top container">
  0     <div class="footer-links">
  0         <a href="/about"><i class="fas fa-info-circle"></i> About Us</a>
  0         <a href="/contact"><i class="fas fa-envelope"></i> Contact</a>
  0         <a href="https://wa.me/923313067328" target="_blank"><i class="fab fa-whatsapp"></i> WhatsApp</a>
  0     </div>
  0     <div class="footer-logo">
  0         <img src="assets/images/logo.png" alt="Dani Medico Logo" class="logo-img">
  0     </div>
  0     <div class="social-icons">
  0         <a href="https://web.facebook.com/Danimedicoo/" target="_blank" title="Facebook"><i class="fab fa-facebook-f"></i></a>
  0         <a href="https://whatsapp.com/channel/0029VadsNMoLikg6LUsxkF0u" target="_blank" title="WhatsApp"><i class="fab fa-whatsapp"></i></a>
  0         <a href="https://www.instagram.com/dani_medicoo?igsh=MWFwdWcxZ2h2Yzg1Yg==" target="_blank" title="Instagram"><i class="fab fa-instagram"></i></a>
  0         <a href="https://youtube.com/@danimedicoo?si=bI1fbH1x4p3gHwss" target="_blank" title="YouTube"><i class="fab fa-youtube"></i></a>
  0     </div>
  0 </div>
  0 <div class="footer-bottom">
  0     <p><i class="fas fa-heart" style="color: #ff4757;"></i> &copy; 2025 Dani Medico. Empowering Future Doctors. All rights reserved.</p>
  0 </div>
</footer>

<script>
    /* --- DATA & FILTERS PRESERVED EXACTLY --- */
    const mdcatExams = ["MDCAT", "BSN", "NUMS", "AKU", "AFNS"];
    const examSubjects = { "all": ["All Subjects"], "MDCAT": ["Biology", "Chemistry", "Physics", "English", "Logical Reasoning"], "BSN": ["Biology", "Chemistry", "Physics", "English", "Logical Reasoning"], "NUMS": ["Biology", "Chemistry", "Physics", "English", "Logical Reasoning"], "AKU": ["Biology", "Chemistry", "Physics", "English", "Logical Reasoning"], "AFNS": ["Biology", "Chemistry", "Physics", "English", "Logical Reasoning"] };
    const examSubjectChapters = { "MDCAT_Biology": ["1. ACELLULAR LIFE", "2. BIOENERGETICS", "3. BIOLOGICAL MOLECULES", "4. CELL STRUCTURE & FUNCTION", "5. COORDINATION & CONTROL", "6. ENZYMES", "7. EVOLUTION", "8. REPRODUCTION", "9. SUPPORT & MOVEMENT", "10. INHERITENCE", "11. CIRCULATION", "12. IMMUNITY", "13. RESPIRATION", "14. DIGESTION", "15. HOMEOSTASIS", "16. BIOTECHNOLOGY"], "MDCAT_Chemistry": ["1. INTRO TO FUNDAMENTAL CONCEPTS OF CHEMISTRY", "2. ATOMIC STRUCTURE", "3. GASES", "4. LIQUIDS", "5. SOLIDS", "6. CHEMICAL EQUILIBRIUM", "7. REACTION KINETICS", "8. THERMO-CHEMISTRY & ENERGETICS OF CHEMICAL REACTIONS", "9. ELECTROCHEMISTRY", "10. CHEMICAL BONDING", "11.S & P Block Elements", "12.TRANSITION ELEMENTS", "13.FUNDAMENTAL PRINCIPLES OF ORGANIC CHEMISTRY", "14.CHEMISTRY OF HYDROCARBONS", "15.ALKYL HALIDES", "16.ALCOHOLS & PHENOLS", "17.ALDEHYDES & KETONES", "18. CARBOXYLIC ACIDS", "19. MACROMOLECULES"], "MDCAT_Physics": ["1.VECTORS & EQUILIBRIUM", "2.FORCE & MOTION", "3.WORK & ENERGY", "4.ROTATIONAL & CIRCULAR MOTION", "5.FLUID DYNAMICS", "6.WAVES", "7.THERMODYNAMICS", "8.ELECTROSTATICS", "9.CURRENT ELECTRICITY", "10.ELECTROMAGNETISM", "11.ELECTROMAGNETIC INDUCTION", "12.ALTERNATING CURRENT", "13.ELECTRONICS", "14.DAWN OF MODERN PHYSICS", "15.ATOMIC SPECTRA", "16.NUCLEAR PHYSICS"] };

    // --- FULL TESTS DATA PRESERVED ---
    const testsData = [{"id": "T1","title": "BIOLOGY SINDH MDCAT","subject": "Biology","chapter": "1. ACELLULAR LIFE","exam": "MDCAT","province": "Sindh","mcqs":[{"q": "Viruses are classified as acellular because they:","options": ["Have cells but are small","Lack cellular structure","Are multicellular","Have organelles"],"answer": 1},{"q": "Viruses are considered:","options": ["Living organisms","Non-living outside host","Both living and non-living","Always living"],"answer": 1},{"q": "The genetic material of viruses can be:","options": ["DNA only","RNA only","DNA or RNA","Proteins"],"answer": 2},{"q": "Viruses that infect bacteria are called:","options": ["Bacteriophages","Retroviruses","Mycoviruses","Arboviruses"],"answer": 0},{"q": "HIV is a:","options": ["DNA virus","RNA retrovirus","Bacteriophage","Plant virus"],"answer": 1},{"q": "The protein coat of a virus is called:","options": ["Capsid","Envelope","Nucleocapsid","Membrane"],"answer": 0},{"q": "Viruses that have an outer lipid membrane are called:","options": ["Naked viruses","Enveloped viruses","Capsid viruses","Simple viruses"],"answer": 1},{"q": "TMV (Tobacco Mosaic Virus) is a:","options": ["DNA virus","RNA virus","Retrovirus","Bacteriophage"],"answer": 1},{"q": "Which virus causes AIDS?","options": ["HPV","HIV","HBV","HCV"],"answer": 1},{"q": "HIV attacks specifically:","options": ["B-cells","Helper T-cells (CD4+)","Red blood cells","Platelets"],"answer": 1},{"q": "The mode of HIV transmission does NOT include:","options": ["Sexual contact","Blood transfusion","Sharing needles","Casual contact like hugging"],"answer": 3},{"q": "HIV can be transmitted from mother to child through:","options": ["Placenta","Breast milk","During delivery","All of these"],"answer": 3},{"q": "The enzyme that converts RNA to DNA in HIV is:","options": ["Reverse transcriptase","DNA polymerase","RNA polymerase","Ligase"],"answer": 0},{"q": "The shape of HIV is:","options": ["Helical","Icosahedral","Complex","Spherical with spikes"],"answer": 3},{"q": "Which is NOT a symptom of AIDS?","options": ["Persistent fever","Weight loss","Increased immunity","Opportunistic infections"],"answer": 2},{"q": "Opportunistic infections in AIDS patients are caused by:","options": ["Weakened immune system","Strong immune system","Genetic factors","Nutritional factors"],"answer": 0},{"q": "Kaposi's sarcoma in AIDS patients is a type of:","options": ["Bacterial infection","Viral infection","Fungal infection","Cancer"],"answer": 3},{"q": "Pneumocystis pneumonia in AIDS is caused by:","options": ["Bacteria","Virus","Fungus","Protozoan"],"answer": 2},{"q": "The window period in HIV infection refers to:","options": ["Time between infection and antibody detection","Time between infection and symptoms","Life span of virus","Incubation period"],"answer": 0},{"q": "ELISA test for HIV detects:","options": ["Virus particles","Antibodies against HIV","CD4 cells","Reverse transcriptase"],"answer": 1},{"q": "Western blot test is used to:","options": ["Confirm HIV infection","Treat AIDS","Prevent HIV","Isolate virus"],"answer": 0},{"q": "HAART stands for:","options": ["Highly Active Antiretroviral Therapy","HIV Active Antiretroviral Treatment","Human AIDS Antiretroviral Therapy","Highly Active AIDS Retroviral Treatment"],"answer": 0},{"q": "AZT (Zidovudine) is a:","options": ["Protease inhibitor","Reverse transcriptase inhibitor","Entry inhibitor","Integrase inhibitor"],"answer": 1},{"q": "Viruses are obligate intracellular parasites because they:","options": ["Can live outside host","Require host cell for reproduction","Are photosynthetic","Can reproduce on their own"],"answer": 1},{"q": "Bacteriophages have which shape?","options": ["Spherical","Helical","Complex with head and tail","Rod-shaped"],"answer": 2},{"q": "Lytic cycle of bacteriophage ends with:","options": ["Integration into host DNA","Lysis of host cell","Formation of prophage","Latent infection"],"answer": 1},{"q": "Lysogenic cycle involves:","options": ["Immediate host cell lysis","Integration of viral DNA into host genome","Production of virions immediately","No replication"],"answer": 1},{"q": "Prophage is:","options": ["Free virus particle","Integrated viral DNA in bacterial chromosome","Viral RNA","Viral protein"],"answer": 1},{"q": "Viruses that cause cancer are called:","options": ["Oncogenic viruses","Bacteriophages","Retroviruses","All viruses"],"answer": 0},{"q": "HPV (Human Papillomavirus) can cause:","options": ["Cervical cancer","Liver cancer","Lung cancer","Brain cancer"],"answer": 0},{"q": "Hepatitis B virus can cause:","options": ["Liver cancer","Lung cancer","Skin cancer","Blood cancer"],"answer": 0},{"q": "Influenza virus has:","options": ["DNA genome","RNA genome with segments","Single RNA strand","Double DNA strand"],"answer": 1},{"q": "The spikes on influenza virus contain:","options": ["Hemagglutinin (HA) and Neuraminidase (NA)","Reverse transcriptase","DNA polymerase","Capsid proteins"],"answer": 0},{"q": "Rabies virus has which shape?","options": ["Helical","Icosahedral","Bullet-shaped","Spherical"],"answer": 2},{"q": "Polio virus is a:","options": ["DNA virus","RNA virus","Retrovirus","Bacteriophage"],"answer": 1},{"q": "Smallpox virus is a:","options": ["DNA virus","RNA virus","Retrovirus","Prion"],"answer": 0},{"q": "Prions are:","options": ["Viruses","Infectious proteins","Bacteria","Fungi"],"answer": 1},{"q": "Mad cow disease is caused by:","options": ["Virus","Bacterium","Prion","Fungus"],"answer": 2},{"q": "Viroids are:","options": ["Infectious RNA without protein coat","Infectious DNA","Infectious proteins","Small bacteria"],"answer": 0},{"q": "Viroids cause diseases in:","options": ["Animals","Plants","Bacteria","Humans"],"answer": 1},{"q": "Which virus has double-stranded DNA?","options": ["HIV","Influenza","Herpes","Polio"],"answer": 2},{"q": "Retroviruses use which enzyme to make DNA from RNA?","options": ["DNA polymerase","RNA polymerase","Reverse transcriptase","Ligase"],"answer": 2},{"q": "Provirus is:","options": ["Viral RNA","Integrated viral DNA in eukaryotic cell","Free virus","Viral protein"],"answer": 1},{"q": "The latency period in HIV infection can last:","options": ["Few days","Few weeks","Months to years","Hours"],"answer": 2},{"q": "AIDS is diagnosed when CD4 count falls below:","options": ["500 cells/µL","200 cells/µL","1000 cells/µL","50 cells/µL"],"answer": 1},{"q": "Which is NOT an opportunistic infection in AIDS?","options": ["Tuberculosis","Candidiasis","Common cold","Toxoplasmosis"],"answer": 2},{"q": "HIV belongs to which family?","options": ["Herpesviridae","Retroviridae","Picornaviridae","Orthomyxoviridae"],"answer": 1},{"q": "HIV specifically binds to which receptor on host cell?","options": ["CD4 receptor","CD8 receptor","CD19 receptor","CD20 receptor"],"answer": 0},{"q": "Besides CD4, HIV also needs which co-receptor?","options": ["CCR5 or CXCR4","CD8","CD19","CD28"],"answer": 0},{"q": "Which cells besides T-helper cells can HIV infect?","options": ["Macrophages","Dendritic cells","Microglial cells","All of these"],"answer": 3},{"q": "The most common mode of HIV transmission worldwide is:","options": ["Sexual transmission","Blood transfusion","Needle sharing","Mother to child"],"answer": 0},{"q": "HIV is NOT transmitted through:","options": ["Sweat","Saliva","Tears","All of these"],"answer": 3},{"q": "The structure of HIV contains:","options": ["Two single-stranded RNA","One double-stranded DNA","Single-stranded DNA","Double-stranded RNA"],"answer": 0},{"q": "The outer envelope of HIV is derived from:","options": ["Host cell membrane","Viral proteins only","Bacterial membrane","Fungal cell wall"],"answer": 0},{"q": "GP120 and GP41 are:","options": ["HIV envelope glycoproteins","HIV enzymes","Host cell receptors","Antibodies"],"answer": 0},{"q": "Which enzyme integrates viral DNA into host genome?","options": ["Reverse transcriptase","Integrase","Protease","Ligase"],"answer": 1},{"q": "Protease enzyme in HIV is important for:","options": ["Cutting viral polyproteins","Converting RNA to DNA","Integration","Entry"],"answer": 0},{"q": "HIV replication occurs in:","options": ["Cytoplasm only","Nucleus only","Both cytoplasm and nucleus","Mitochondria"],"answer": 2},{"q": "During HIV infection, which antibodies are produced first?","options": ["IgG","IgM","IgA","IgE"],"answer": 1},{"q": "The asymptomatic stage of HIV infection is called:","options": ["Acute phase","Chronic phase","AIDS","Window period"],"answer": 1},{"q": "Acute HIV infection symptoms resemble:","options": ["Common cold or flu","Malaria","Tuberculosis","Diabetes"],"answer": 0},{"q": "Which body fluid has highest concentration of HIV?","options": ["Blood","Semen","Vaginal fluid","Breast milk"],"answer": 0},{"q": "Pre-exposure prophylaxis (PrEP) is:","options": ["Treatment after infection","Prevention before exposure","Vaccine","Diagnostic test"],"answer": 1},{"q": "PEP (Post-exposure prophylaxis) should be started within:","options": ["24-72 hours after exposure","1 week","1 month","6 hours"],"answer": 0},{"q": "Mother-to-child transmission of HIV can be reduced by:","options": ["Antiretroviral drugs during pregnancy","Cesarean delivery","Avoiding breastfeeding","All of these"],"answer": 3},{"q": "Which is NOT a class of antiretroviral drugs?","options": ["Nucleoside reverse transcriptase inhibitors","Protease inhibitors","Integrase inhibitors","Penicillins"],"answer": 3},{"q": "Vaccine for HIV is:","options": ["Available and effective","Not yet available","Only for animals","Only for certain strains"],"answer": 1},{"q": "Which test measures viral load in HIV patients?","options": ["ELISA","Western blot","PCR","CD4 count"],"answer": 2},{"q": "CD4 count in healthy individual is about:","options": ["200-500 cells/µL","500-1500 cells/µL","50-200 cells/µL","2000-3000 cells/µL"],"answer": 1},{"q": "HIV can be inactivated by:","options": ["Heat","Bleach","Alcohol","All of these"],"answer": 3},{"q": "Which virus causes chickenpox?","options": ["Varicella-zoster virus","HIV","HPV","HBV"],"answer": 0},{"q": "Which virus is transmitted by mosquito?","options": ["Dengue virus","HIV","Hepatitis B","Influenza"],"answer": 0},{"q": "Arboviruses are transmitted by:","options": ["Arthropods","Air","Water","Food"],"answer": 0},{"q": "Rotavirus causes:","options": ["Diarrhea in children","Respiratory infection","Liver disease","Neurological disease"],"answer": 0},{"q": "Norovirus causes:","options": ["Gastroenteritis","AIDS","Hepatitis","Influenza"],"answer": 0},{"q": "Rhinovirus causes:","options": ["Common cold","AIDS","Hepatitis","Rabies"],"answer": 0},{"q": "Coronaviruses can cause:","options": ["Common cold","SARS","MERS","All of these"],"answer": 3},{"q": "Ebola virus causes:","options": ["Hemorrhagic fever","Respiratory illness","Liver disease","Neurological disease"],"answer": 0},{"q": "Zika virus is transmitted by:","options": ["Mosquito","Sexual contact","Mother to fetus","All of these"],"answer": 3},{"q": "Viruses are measured in:","options": ["Micrometers","Nanometers","Millimeters","Centimeters"],"answer": 1},{"q": "The largest viruses are comparable in size to:","options": ["Bacteria","Red blood cells","Atoms","Molecules"],"answer": 0},{"q": "Mimivirus is notable for its:","options": ["Small size","Large size and genome","Lack of DNA","Plant infection"],"answer": 1},{"q": "Bacteriophages were discovered by:","options": ["Alexander Fleming","Frederick Twort and Felix d'Herelle","Louis Pasteur","Robert Koch"],"answer": 1},{"q": "TMV was discovered by:","options": ["Dimitri Ivanovsky","Louis Pasteur","Robert Koch","Edward Jenner"],"answer": 0},{"q": "The first human virus discovered was:","options": ["Yellow fever virus","HIV","Influenza virus","Polio virus"],"answer": 0},{"q": "Viruses can be cultured in:","options": ["Artificial media","Living cells only","Both","None"],"answer": 1},{"q": "Plaque assay is used to:","options": ["Count viruses","Count bacteria","Measure pH","Detect antibodies"],"answer": 0},{"q": "Viruses that cause tumors are called:","options": ["Oncogenic viruses","Cytopathic viruses","Latent viruses","Lytic viruses"],"answer": 0},{"q": "Latent viral infection means:","options": ["Virus replicates continuously","Virus remains dormant","Immediate symptoms","Rapid lysis"],"answer": 1},{"q": "Herpes virus can remain:","options": ["Latent in nerve cells","Active always","Only in blood","In digestive system"],"answer": 0},{"q": "Cold sores are caused by:","options": ["Herpes simplex virus","HIV","Influenza","Rhinovirus"],"answer": 0},{"q": "Shingles is caused by reactivation of:","options": ["Varicella-zoster virus","HIV","HPV","HBV"],"answer": 0},{"q": "Viruses can be prevented by:","options": ["Antibiotics","Vaccines","Both","Neither"],"answer": 1},{"q": "Antibiotics are ineffective against viruses because viruses:","options": ["Have cell walls","Lack metabolic pathways targeted by antibiotics","Are too small","Are living"],"answer": 1},{"q": "Interferons are produced by host cells in response to:","options": ["Bacterial infection","Viral infection","Fungal infection","All"],"answer": 1},{"q": "Viruses can be visualized using:","options": ["Light microscope","Electron microscope","Naked eye","Telescope"],"answer": 1},{"q": "The capsid is made of protein subunits called:","options": ["Capsomeres","Envelopes","Spikes","Nucleoids"],"answer": 0},{"q": "Icosahedral capsid has how many faces?","options": ["10","20","30","40"],"answer": 1},{"q": "Helical capsid is found in:","options": ["TMV","HIV","Adenovirus","Polio virus"],"answer": 0},{"q": "Complex capsid is found in:","options": ["Bacteriophages","HIV","Influenza","Herpes"],"answer": 0},{"q": "Viral envelopes are acquired from:","options": ["Host cell membranes","Viral synthesis","Environment","Other viruses"],"answer": 0},{"q": "Enveloped viruses are generally more susceptible to:","options": ["Detergents","Heat","Drying","All"],"answer": 3},{"q": "Naked viruses are more resistant to:","options": ["Environmental conditions","Antibiotics","Antibodies","All"],"answer": 0},{"q": "Viruses that infect plants often enter through:","options": ["Wounds","Stomata","Roots","All"],"answer": 0},{"q": "Plant viruses are often transmitted by:","options": ["Insects","Nematodes","Fungi","All"],"answer": 3},{"q": "Viruses can be used in biotechnology for:","options": ["Gene therapy","Vaccine production","As vectors","All"],"answer": 3},{"q": "The study of viruses is called:","options": ["Bacteriology","Virology","Mycology","Parasitology"],"answer": 1},{"q": "Which statement about viruses is correct?","options": ["They have both DNA and RNA","They can reproduce independently","They are acellular","They have ribosomes"],"answer": 2}]}];

    let activeTestMCQs = [], userSelections = [], currentOpenTest = null, timerInterval = null, totalSeconds = 0, selectedPct = 1.0, pendingTestId = null, currentStep = 0;

    /* --- LOGIC PRESERVED & UPDATED --- */
    function initializeFilters() { updateExams(); }

    function updateExams() {
        const examSelect = document.getElementById('filter-exam');
        examSelect.innerHTML = '<option value="all">All Exams</option>';
        mdcatExams.forEach(exam => {
            const option = document.createElement('option');
            option.value = exam; option.textContent = exam; examSelect.appendChild(option);
        });
        updateSubjects();
    }

    function updateSubjects() {
        const exam = document.getElementById('filter-exam').value;
        const subSelect = document.getElementById('filter-subject');
        subSelect.innerHTML = '<option value="all">All Subjects</option>';
        if (exam !== 'all') {
            (examSubjects[exam] || []).forEach(sub => {
                const option = document.createElement('option');
                option.value = sub; option.textContent = sub; subSelect.appendChild(option);
            });
        }
        updateChapters();
    }

    function updateChapters() { loadTests(); }

    function loadTests() {
        const container = document.getElementById('tests-container');
        const provVal = document.getElementById('filter-province').value;
        const examVal = document.getElementById('filter-exam').value;
        
        const filtered = testsData.filter(t => (provVal === 'all' || t.province === provVal) && (examVal === 'all' || t.exam === examVal));
        
        container.innerHTML = filtered.map(test => `
            <div class="card">
                <div>
                    <h4>${test.title}</h4>
                    <div class="card-meta">
                        <span><i class="fas fa-list-ol"></i> ${test.mcqs.length} MCQs</span>
                        <span><i class="fas fa-graduation-cap"></i> ${test.exam}</span>
                        <span><i class="fas fa-map-marker-alt"></i> ${test.province}</span>
                    </div>
                </div>
                <button class="primary-button" onclick="openConfigModal('${test.id}')"><i class="fas fa-play"></i> Start Test</button>
            </div>
        `).join('');
    }

    function openConfigModal(id) { pendingTestId = id; document.getElementById('configModal').style.display = 'block'; }
    function closeModal(id) { document.getElementById(id).style.display = 'none'; document.body.style.overflow = 'auto'; clearInterval(timerInterval); }

    function setPercentage(val, btn) {
        selectedPct = val;
        document.querySelectorAll('.pct-btn').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
    }

    function handleDetailsSubmit(e) {
        e.preventDefault();
        document.getElementById('configModal').style.display = 'none';
        openActualTest(pendingTestId);
    }

    /* --- UPDATED INTERACTIVE QUIZ LOGIC --- */
    function openActualTest(id) {
        const test = testsData.find(t => t.id === id);
        currentOpenTest = test;
        const qty = Math.floor(test.mcqs.length * selectedPct);
        activeTestMCQs = [...test.mcqs].sort(() => 0.5 - Math.random()).slice(0, qty);
        userSelections = new Array(activeTestMCQs.length).fill(-1);
        currentStep = 0;
        
        document.getElementById('test-modal-title').innerText = `${test.title} (${selectedPct*100}%)`;
        renderStep();
        document.getElementById('testModal').style.display = 'block';
        startTimer(activeTestMCQs.length * 40); // 40 seconds per MCQ logic
    }

    function renderStep() {
        const m = activeTestMCQs[currentStep];
        const container = document.getElementById('mcq-steps-container');
        
        container.innerHTML = `
            <div class="mcq-step active">
                <p style="color:var(--color-primary-blue); font-weight:700;">Question ${currentStep + 1} of ${activeTestMCQs.length}</p>
                <p style="font-weight:600; font-size:1.1rem; margin-top:10px;">${m.q}</p>
                <div style="margin-top:20px;">
                    ${m.options.map((opt, oi) => `
                        <label style="display:block; padding:15px; border:2px solid #eee; border-radius:10px; cursor:pointer; margin-bottom:10px;" id="label-${currentStep}-${oi}">
                            <input type="radio" name="q${currentStep}" value="${oi}" ${userSelections[currentStep] === oi ? 'checked' : ''} onchange="userSelections[${currentStep}]=${oi}"> ${opt}
                        </label>
                    `).join('')}
                </div>
                <div class="quiz-footer">
                    <button type="button" class="secondary-button" style="width:120px; visibility:${currentStep === 0 ? 'hidden' : 'visible'}" onclick="moveStep(-1)">Previous</button>
                    ${currentStep === activeTestMCQs.length - 1 
                        ? `<button type="button" class="primary-button" style="width:150px; background:var(--color-danger);" onclick="submitTest()">Submit Test</button>`
                        : `<button type="button" class="primary-button" style="width:120px;" onclick="moveStep(1)">Next</button>`}
                </div>
            </div>
        `;
    }

    function moveStep(n) { currentStep += n; renderStep(); }

    function startTimer(sec) {
        totalSeconds = sec;
        updateTimerDisplay();
        timerInterval = setInterval(() => {
            if (--totalSeconds < 0) { clearInterval(timerInterval); submitTest(); }
            else updateTimerDisplay();
        }, 1000);
    }

    function updateTimerDisplay() {
        const m = Math.floor(totalSeconds / 60), s = totalSeconds % 60;
        document.getElementById('time-left').textContent = `${m.toString().padStart(2,'0')}:${s.toString().padStart(2,'0')}`;
    }

    function submitTest(e) {
        if(e) e.preventDefault();
        clearInterval(timerInterval);
        let correct = 0;
        activeTestMCQs.forEach((m, i) => { if(userSelections[i] === m.answer) correct++; });
        
        document.getElementById('result-percentage').innerText = Math.round((correct/activeTestMCQs.length)*100) + "%";
        document.getElementById('final-score').innerText = Math.round((correct/activeTestMCQs.length)*100) + "%";
        document.getElementById('final-correct').innerText = correct;
        document.getElementById('final-total').innerText = activeTestMCQs.length;
        document.getElementById('result-correct').innerText = correct;
        document.getElementById('result-total').innerText = activeTestMCQs.length;

        document.getElementById('mcq-steps-container').innerHTML = '';
        document.getElementById('timer-container').classList.add('hidden');
        document.getElementById('result-summary').classList.remove('hidden');
        document.getElementById('resultPopup').style.display = 'block';
    }

    function checkTest() {
        document.getElementById('resultPopup').style.display = 'none';
        document.getElementById('result-summary').classList.add('hidden');
        document.getElementById('testModal').style.display = 'block';
        currentStep = 0;
        renderReviewStep();
    }

    function renderReviewStep() {
        const m = activeTestMCQs[currentStep];
        const sel = userSelections[currentStep];
        const container = document.getElementById('mcq-steps-container');
        
        container.innerHTML = `
            <div class="mcq-step active">
                <p style="font-weight:600; font-size:1.1rem;">${m.q}</p>
                <div style="margin-top:20px;">
                    ${m.options.map((opt, oi) => {
                        let cls = "";
                        if(oi === m.answer) cls = "correct-ans";
                        else if(oi === sel) cls = "wrong-ans";
                        return `<label class="${cls}" style="display:block; padding:15px; border:2px solid #eee; border-radius:10px; margin-bottom:10px;">${opt}</label>`;
                    }).join('')}
                </div>
                <div class="quiz-footer">
                    <button type="button" class="secondary-button" style="width:120px; visibility:${currentStep === 0 ? 'hidden' : 'visible'}" onclick="moveReview(-1)">Prev</button>
                    <button type="button" class="primary-button" style="width:120px; visibility:${currentStep === activeTestMCQs.length-1 ? 'hidden' : 'visible'}" onclick="moveReview(1)">Next</button>
                </div>
            </div>
        `;
    }
    function moveReview(n) { currentStep += n; renderReviewStep(); }

    /* --- PDF LOGIC (PRESERVED) --- */
    function downloadTestPDF() {
        const { jsPDF } = window.jspdf; const doc = new jsPDF();
        const stdName = document.getElementById('user-name').value || "Student";
        const scorePct = document.getElementById('final-score').innerText;
        doc.setFillColor(0, 123, 255); doc.rect(0, 0, 210, 45, 'F');
        doc.setTextColor(255, 255, 255); doc.setFontSize(24); doc.setFont("helvetica", "bold");
        doc.text("DANI MEDICO", 14, 20);
        doc.setFontSize(10); doc.setFont("helvetica", "normal");
        doc.text("Your Success, Our Mission - Quality Medical Preparation", 14, 28);
        doc.setTextColor(0,0,0); doc.text(`Name: ${stdName}`, 14, 60); doc.text(`Score: ${scorePct}`, 14, 70);
        doc.save(`DaniMedico_${stdName}.pdf`);
    }

    document.addEventListener('DOMContentLoaded', initializeFilters);
    function mobileMenuToggle() { document.getElementById('navLinks').classList.toggle('active'); }
</script>
</body>
</html>
